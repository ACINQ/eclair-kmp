package fr.acinq.lightning.serialization

import fr.acinq.bitcoin.Transaction
import fr.acinq.bitcoin.byteVector
import fr.acinq.lightning.CltvExpiryDelta
import fr.acinq.lightning.Feature
import fr.acinq.lightning.Lightning
import fr.acinq.lightning.blockchain.BITCOIN_FUNDING_DEPTHOK
import fr.acinq.lightning.blockchain.WatchEventConfirmed
import fr.acinq.lightning.channel.*
import fr.acinq.lightning.channel.TestsHelper.processEx
import fr.acinq.lightning.channel.states.WaitForFundingConfirmedTestsCommon
import fr.acinq.lightning.tests.TestConstants
import fr.acinq.lightning.utils.UUID
import fr.acinq.lightning.utils.msat
import fr.acinq.lightning.wire.ChannelReady
import fr.acinq.lightning.wire.UpdateAddHtlc
import fr.acinq.secp256k1.Hex
import kotlin.test.*

class CompatibilityTestsCommon {
    @Ignore
    @Test
    fun `generate data`() {
        // generate test data
        val (alice, bob, fundingTx) = run {
            val (alice0, bob0, txSigsBob) = WaitForFundingConfirmedTestsCommon.init(ChannelType.SupportedChannelType.AnchorOutputs)
            val (alice1, actions1) = alice0.processEx(ChannelEvent.MessageReceived(txSigsBob), minVersion = 3)
            assertIs<WaitForFundingConfirmed>(alice1)
            val fundingTx = actions1.find<ChannelAction.Blockchain.PublishTx>().tx
            Triple(alice1, bob0, fundingTx)
        }
        println("funding_tx: ${Transaction.write(fundingTx).byteVector().toHex()}")
        val bin = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob)
        println("wait_for_funding_confirmed: ${bin.data}")

        val (bob1, actionsBob) = bob.processEx(ChannelEvent.WatchReceived(WatchEventConfirmed(bob.channelId, BITCOIN_FUNDING_DEPTHOK, 42, 0, fundingTx)), minVersion = 3)
        val channelReady = actionsBob.findOutgoingMessage<ChannelReady>()
        assertTrue(bob1 is WaitForChannelReady)

        val bin1 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob1)
        println("wait_for_channel_ready: ${bin1.data}")

        val (alice1, actionsAlice) = alice.processEx(ChannelEvent.MessageReceived(channelReady), minVersion = 3)
        assertTrue(alice1 is WaitForFundingConfirmed && alice1.deferred == channelReady)

        assertTrue(actionsAlice.isEmpty()) // alice waits until she sees on-chain confirmations herself
        val (alice2, actionsAlice2) = alice1.processEx(ChannelEvent.WatchReceived(WatchEventConfirmed(alice.channelId, BITCOIN_FUNDING_DEPTHOK, 0, 42, fundingTx)), minVersion = 3)
        val channelReadyAlice = actionsAlice2.findOutgoingMessage<ChannelReady>()
        val (bob2, _) = bob1.processEx(ChannelEvent.MessageReceived(channelReadyAlice), minVersion = 3)
        assertTrue(bob2 is Normal)

        val bin2 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob2)
        println("normal: ${bin2.data}")

        val add1 = CMD_ADD_HTLC(
            10_000.msat,
            Lightning.randomBytes32(),
            CltvExpiryDelta(144).toCltvExpiry(TestConstants.defaultBlockHeight.toLong()),
            TestConstants.emptyOnionPacket,
            UUID.randomUUID()
        )
        val add2 = CMD_ADD_HTLC(
            10_000.msat,
            Lightning.randomBytes32(),
            CltvExpiryDelta(144).toCltvExpiry(TestConstants.defaultBlockHeight.toLong()),
            TestConstants.emptyOnionPacket,
            UUID.randomUUID()
        )
        val (alice3, actionsAlice3) = alice2.processEx(ChannelEvent.ExecuteCommand(add1), minVersion = 3)
        val (_, actionsAlice4) = alice3.processEx(ChannelEvent.ExecuteCommand(add2), minVersion = 3)
        val htlc1 = actionsAlice3.findOutgoingMessage<UpdateAddHtlc>()
        val htlc2 = actionsAlice4.findOutgoingMessage<UpdateAddHtlc>()

        val (bob3, _) = bob2.processEx(ChannelEvent.MessageReceived(htlc1), minVersion = 3)
        val (bob4, _) = bob3.processEx(ChannelEvent.MessageReceived(htlc2), minVersion = 3)
        val (bob5, _) = bob4.processEx(ChannelEvent.ExecuteCommand(add1), minVersion = 3)
        val (bob6, _) = bob5.processEx(ChannelEvent.ExecuteCommand(add2), minVersion = 3)
        assertTrue(bob6 is Normal)

        val bin3 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob6)
        println("normal_with_htlcs: ${bin3.data}")
    }

    @Test
    fun `read compatibility test data`() {
        // data was generated with lightning-kmp v1.5.0
        // README: it this test fails it means that we cannot decrypt and/or deserialize data created with on older version of the app !!
        val fundingTx = Transaction.read(
            "020000000001028bbe6cbb9197f4ff08db4fd1936dd16ad9a0bbcd3d4bb9ea68eb88df231422640000000000000000008e4faf8e753a822ad14d1921bff69910cc9d6b5916b9c6da645723deddffee740000000000000000000140420f000000000022002078d561e62ed6ed81f721b7520ea0128abe0282d1a626acc0ca8a7f323d19920d0248304502210089f02b22dfad73b51e74d15c89cab509cdee27f8d357151730d300873d0ecaff02204fc96e7f39a7589baa22cb404bcebf8f9199cbc3cb46c3a632d58416a674f2d4012103889dbe4a67abd4e18cac0c06cac813ac3c9846d0566b5b7f1bb2a5ab41ec20210247304402201a49eaf510bfa8712c82ec8d22c102af83d22b17900498e189791254a2f8ec7c02204fe7f4948aece588f53e21c96c1f3c5408c5a0f406f9b423a1d11205b252745701210274660d31256d702932ba075359018990ea18c6a001ccbde6f65dc63bc9245fd8801a0600"
        )
        val waitForFundingConfirmed = Hex.decode(
            "2dfb491575dee0fa2ac8de1dbbd2a4e7404eb61d5d7e3a09baada199c23ca673adb2cad427182a0f6c2c55ddb8289dbc9ed3e045b172a119853f192706b55b5d9b564cf058d568f31b5ff20cc9125ca555c59613047363af91c0d5052769bdece3d8ca1441c7b126c4927608446d58dfa8bdbaef7ebeb5ea5c4e312df424fac40596f6afa92b7417e0262f62e24c30dc7099a8cf2a086e532f17f962ed5ec9915cea3fc73dd60775203c31809f38fade1756de8f025ed6aac3291d0305a6c9542e87a9c7b272d8589ccf463ce2405fb457b0fab1f0f11d297a79607482445b95586bcfe50c3450b69492b9933d2aa87547a9d7c6b637fe8c3bf40217d721d5daa8d2192cb7750e6b8aa617645cfeeaa75529e01df1df98cb9e71f25ebce5e93debaac92ea1ab2c11e2162b9b563aeabde80ffd3f8c5c945bdfc0c407cffb6f4290be69370319533b7ffc48521c6ba218a0eb59c0597ead23de74662c51816c6d5b682cbff41f0b897284b59ef28f4739c3522607269e47fbf814eb955b4113dd9f1d782c4d44b86f390a2a980a34d4015ed5494c6ee41aeacb26f2ed714f55efd25ccf652f8591dd2c5e80c40f52db0e02d243f9f806742183054ea1773c496367396a0042e5356e65f74240fa80bad8cb322f2f82272b79cb4f5286121612c4030a26ebab11c2680d72530dc2b48d364e895c27d2cf2b661f9156961895ae3b94204b43d593925d5d7d769710db232ada46237a957ea2f3c9617c00ca7e8b1807152e5b1283e6581085f13e1dacd6e8b14a6354a7e2e36024850b6c050b30189c42baf68dbee277bca88fd2d3533245503c7b5342e261b61e52a1d48b57eb5eda074f03d179b585b2853a98d23d5fa5c8f5cca904e2fe6eb7025fbbf8573a4f5e49ea678c806b18168a461bc99317d738417846aa754fe1b387ae9c8f716386caad306b850929e4d678bd82c0b9277063548c0f5950240cd25585d3a2e3bd7083a40e8a656b48fae773b663d8f1cb22f043072eb80b1e716f1ddbc066223b5aec5b6bc61503bd95e8daead6fdabb524ff78289c70a27f666764836cc8241a62832f7b26c25123a16240ead3359a3c69d551ac954e9921077d45bd62face59f0c7dbc38b4d750ab3d862d42d66af0c6412af0fc2cd8f80cdc67d865aff9c2111a30c7ebba53a85bc5f3d824b62560aa4978fa340c11215079c9d7a5227352dba9ffb9327cf913d486c8b4c53a4e5cd4213f342d7077027384557dc65e77e0c53edf298d949478eaecdddebe37cd0045669eb6bebecd75a56c1a2e863771552c9fe2a2a144c82393989c4696add5d76fa613a9b736813344b84591831591debaefae464db588d6228a0f00ca56c9a21e19fe2437ad69c6b4b217433e92ba01dee403e3180762158cd52d9a0cae3861429fc332cf2b59fc2e1ef42bac459e94f12e39c2c3a0414b347c7b003f9f7def61f88b87051e4c123d198f8db0cd145848b87c4aeb426c32c8c87104a1730f51152e7fb060ce65ab3577516be51794f7f76a84593fa5b4bafc6dbb030ed31f12e0823e043072690d530d5b285ba90d6c9ed23f5698c2905d114021f61ebee16db48b8aef9aea680fc0168450c37bc2057daca148e690bf6e00d889a9f11eb0e0d222db2d89c58d088d68a1a0c7fe0f274c8bd59905acbabaaf0cf10cbbd3317f7eb74af1df3998e8349b9e19ee47b36abb3ea208fd785f4d21b10b60daaff308bc18d4afa943f9f13ce7b9842951607e556aaf2d2ff9af0a9db75ac19b8f69e0fdd106bd90f84555c73c0086619afcdb1a0074d2939cab81950a22dfbdefaac049fa570d59684e746b70c8b3e0c17614b6065702ce4f163647c5642f8d554938d21d190344076002b1b31194a5f33625c35b9bd92a32eea6b90779d2c2d0093f6d28debbf1de90a9eb1ffb841798101c988694fe6bf258820ee4d042c70ba5c645bf4117b687bb26916e8685720a2657a10140714b8d7d5a4f5580e7ed1543b7e5cba96b3d73ab584d5a593847f6ea69a5c1e3e4c73e31d2906a22913968bc67539ba5e307e36848ed695f0f2915cbbbe7c1a10d44bd185c420b0a17c013c8655719723532a3df3ee31ce74a6fe0324def2df6132e0cd0a5c79493a93d583744218a2949f95557b30ea6570cf3def0212f9d024004808374911149e3d493d3bac4d8f7d66e88630caeccdd160e064be5bd6541de76af76b0a4ea45828181dff13af84a7a22af278c8ebb781a01c96041f467b49a930f7a9c325e0e6d10f26de5a0a3e56a362def704388685030b1c9000183d6997a843f8c13e2e8af7c6c36f5ac26bafb9748964680c1192a07e46fbd660c42116b749b3d47947ab8e97b1f1999745138686c7f6d13ea5d66355554a249e608eb62760784003c68e8808d6dd7163d0a5abdb8f39ac4c10b325e79510d4ad739421bb2daa8d118c054b5b397f4ed19b35945e888928716588839ca81d15f42ac79c76d20094342a3727f3f59a09274c1124b0b31e0981d40cfb56b2069d43941e3e1d256beb34ed3cad7aef1b4bb5f804d4d6660c38e78d0d59e9a0cf7fa7d345ce638cd67c0281b54df822ccc0e4664fd0bbb887fedf0ad8742a477bfc07761f0cd6733b2e86175a843ee191eb6381ea702a31a63904554d802fd88093bad636224caf220024590c0ae1998f5aa873862eb0d70c0a3178979599af490e44bb991eeb45404422d5752bffb90f6ffccad05e750d3e856d17fa3d130286a48dace995261f2c9c964c79cb6d8d69d253a67da105968e6a18a3591b0438d2810ff75af97344306e3ff8828aa0e894b2a92ac610a8fa6a863a3f3be44a9937cca1e89286e49c1dc17371da4789b0eb59af2df88a2d18f3fa666110ca1d34c3354d4f068344037790d969b8b14be5a11aa4c733353c6d6b52840b1f84e856d98867ae615bb811393c66b224243ed986426fc46ec743e16ae7f638d21b7ce2b2d455323cf1e095f8270bcb9b6b7cd387d300b0c80d378be841c70bcfe4a7ca87d5b13d898d0ccfb3e9ad51fe366461304db321beb750182f3bfcfb27a949b3a95baa7a23b58ec985f260e307163c8d0b9a7d328b5c049ecd3efdb904d9ab9e59110ed575590e7e44575a72b87d93dbc746c5cc39a34af0f7152bf185d37c76830982f8cf9d2551d8dae4ed1d0d368b16b85a4155a8cfc39122f03bffa67e0a992f0b36ea904cdc36a60f3b5eb70d805f80624529fc9c64866b33b5e2bdb6f6465f9e7e41156a737f2227556bd26e5e62d771f7851532e06e0bc7ae339018c6c1491d8882c8bf4a0ff282ab30c46dad247a621a16577bd32dfba99bfb881dc789ad9a3fdf9c4754b1e2f38ad8bc51d0060dc320f94b8b507231bfa4eff2ff34056f5e53baa1c431fd2722c464c5c8c1885892ea542674c4c09d73a69e91729167f34659896ed64405b97f749a8273698afabe1d629732ed4a12058544364642646e1e69deecc5f6ad0a307b577f5d09cdd63efe7b617f614a6e755e0baa6cea71be799cf185e2540d25bf6a7adb91a9f588e42f2ba446fe524503a5329113ae90578e49f1f5959cee694a17ef5608ae2ebd0558e206e2a3a734e9984b1d1d4f7af3be8d8d0c0d9f3a4015bfd975fe3dc08546d85b3f66a91dfd82877ee5392708bcefd99aa9649416acafd5b4d3dabd2480485db49f64e8612a422a861fbe6041e1de6178f5e9ba33dff94952f0d716476f886a2c78c6a24dc9402108818a4035f936436cd653f2ba9f4c4082824de4e28a7052c31844e7d972e9b8559866707e52c6a31e17a44781332cb83fb7e36f99614a945b99256b689946478938b3f75393eb086fefc26f552f734f3b183a04dda4afb6a747bb056a999edfad30ca09622d2914884a2479e6867175682babeb7b9855ec87acefaac344236dc24feeba778f343a83f14bf8d9a3465f2ec0e7db31715ec6f3e4c1dc932a403dd76806200a1bc1fea603c3fecd5e1bf20f0cb924ef34f988d7b0a9f4f8d3685fbd77b7795f9ae0032b92140fad61aca9dcf710e5d2c0ba75eeb392e3c53640ae716b507820caadc5bde3ded9cf592701498cc78107413e310f840c67e7fca4b3869185b4859ef59168cc4a2dd3bda80d97f7f9fc3e8ffcd8040c978915d1f9dcb63d9ca97457187141c9a30e11e37ca1c1e06ec0f371c8d83ce57bfc4eb5f5005ccd90da3171a368f3265ce57dd6dc0412ebe76603e1c93688f10b05fd2c2922f7bae417a87a4e24bba4888cf6e4d2aa3781852dab34dd5c78012ab6e72211f746374dd701e74888a0680938d40a3cbb007a6358da27243b9668f51ce457cb9671c3521b2cce0d6790cd6ff8cd1ca16ac08780997c30f60202e95478adc82c69359e7bcbbcb7d1a4e021897b29c5d85c94687956950b4587894e3229d18e2682887befaae6bd97475d9837c5842a20d123429028660cc5374c236e8a1b93af0aa45527f6fdcf3136cd136e37f9cd7c8a1382975bfc874812beb5acd03054ea3cf5d814644e058ed193d4985aa3f845f39e08b403a797b3db1ab3930e9cd4e4304b84f8e794ac835f0feaad3aa7f74e98369bf3b03e33c33b01c86240540cb7de1c45d1986093b91e282f4925336bf9b3c14a73b63890aa9ab2031f2018ef6bf379617addb6216d7117cc23afc2c67ed9ee8d318b5d3a2cbe143aa0513c7831d0917b1daa36b841325e4d3d2f13a946658fc8de4364638911ac69df3f7a99235cd224472f9f4728c007692c4db445aac525cda222e17083c6ccfb810dac75bc974c498332ab29a90137093ca98018d85c9eb34654f49a671f60531dd67f77b0000727f43a140ae0c5c89e8e0a3f6818874454f00ad48a2c1036af1721b3287b630461b7dd238333e642513a1ff550801ae00fed9788b56788d3e18f35bd70c3b1f48cf536a8de4f6c97c5b4904cfd15ab0890451684890803d3f8f17e3860600aa5b66d8b495fab92841586295835dfe0c17144cbbd9ef6144d56dc2a4b099171ec8e7f14f4fc5635569680a289019de1651647e8c26df5cde0b896bc01518b67e7a8a820967b40fb3502f2166321db12a3d4cb9389f29909c1a3112df0c7b958a1a91771c9e0fb068954245f10cc5a260aff35d348969232be2237d1fa5afa8853b7f2f203462c534c6d1b9a9e8b8774e3f72402fdfce9008b07d280fb919d6d7f62f8b695a49d7384bb3dd6660a0e7b98265b3e4c604d88efc8889108e95c8ce8f287bd3c3b207d875ef902e7408e077e804ebd0b6b015928c058fb46b060c55cfb5578e0b0cf0aa63088ca09541ec642f96bd3e21c98c983bb93a5f76797948927c404d6265dd8d80d433b71d2e005e062ab00f86d3c7d918cfb6740fe5799c0e6fc4a2ccfa25d66ec403a8639a1f14aad118a6845302eb6bdff37a74ca7be208108af8b98f14738e5af2ca90f8ba7ee82d9b7867d28a6a1b4fc720d8f6e4c7a7c578f6afa715f94202b926532f9099b8622b14607e9a29d0243b7c6604c2fe8839b581228f83dfa99f1d3aae3bca3a39b041e86c97fad6c57d3dc4ac22f066e33774bba993a33fd492dcf2292e8526fcf50c6beca5d6d0d5a82c71f1ddfadd8ce71aa87e9a6b058b6b93b7a6bbf6333975e2f91b0211efe7427fa5510315e53f8a30fb52fb8fa650008ff57ce4cadafcc4119e0806878096cade5a039c3c420f56b84b1eeebd495407df1964c2bf70575015dbd9e909931c6080af269d07d2fc9537caf8c0c092c92fa74e981667149b787f99a5a8397e926b45025ebbe78bbdc5ee81cc88c73de2377c29d1dcde74c2c42f65256850d5e893fc152e082db0dfae6de359b0c2ae33d3ce9d76fafa316a8f565f2b5eb7b794bb8f8b576920f1d79e2d58897a131f2cec407911398c0cef66ddb97840b38f96854254be2a5f1186a252a1e95864e68f496a7d96a9efb00233dd1113056e41ebd2f58c3bcda1690d92e7d5aced5093e2aea68879d116ac7c400b16a0bff50808c59797520060e6933719277de756d736c6f1a861c2fa0171ff37c9ef927a8a86825385d5bacf700beda5e620243819d14e1f7833fc81f238576c748b530572af4acd1ca137a3930411bad92da15942dad37043f11afc077a9395897029c024cfd1fba5991f67d2aae947dcd42b17c2d64fc749b773690e3509fe45fed73cb32bfaa3a1bd77318d8447e3156754366a6e9ade3e975bd7715462143fb60b56b8abcdc63d0812d840dc6b22460b23caa7afb45ec0973936bbf38985a38b5db42e7c7122a5fd471299da6ae2bbb90159b5e816f038714ffdc024781b0afe28a7ff083b314abfdf6c3d640ce7c9c3134e62b2f16365b21a1bc01bf84ca58a989671f4e0e9c5b4c95b6ce055b0385994f5d73b9de42d82788e6e16cd489343a7e2f5d1c9e940eab4b08d3ca2b4237d1632567f4d16bfa5dc6f796c58d5357f6558ec4cdac1f2ad0594cf927d8335e3761a3060f431a94919367f5aa4ddeefc424fcb0f9ee2cbbb6824bd398dc4122eb9b0e49bfa49a269dd0fa50edece99efb7e59dfa3e8678eafb2563129fc6ef3904b50809bb68445a5577e41d9525f60c1864a6d0d4ac1d3307442fa209082fcc59c0d3282c654149615e6301250345c01f0dd4433ee04e18aaba78b18c449a263708932bb1a8ab880c32b1c0aad488f1dce371fd04439248b015a727ffa31a4dfb0712b06651db5ab4ea3ac9cfc3eb0b40d624381eeaf15c1cedd081b4ae31835e792261ec689e934f8ff8971e0ffa9f1610a4a"
        )
        val state = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, waitForFundingConfirmed, TestConstants.Bob.nodeParams)
        assertIs<WaitForFundingConfirmed>(state)
        assertEquals(state.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val waitForChannelReady = Hex.decode(
            "46664db48214a7dbe3d10041793d88639c6d4e6a7a732ba44990d3e14c7445f2065fbb6ba3106f97be010ca69e32de62dc5c27fe718cbeebe33fe42bd742f8965e36e875ed9f0891b89a969d385ff6c72b76ea9dcc32b456b33e83da62f5e1daadc3f2325299f7d8f49c04a1deb1a3efe09e63792026888a8130b4996d4eea283bec8d3a9953f10f7a1c615d0ea650f63b78fbfdbaf7686532d0f4a44f1264cddab7af4d94c4685b35499184a644bbfefc2d1b9e250bd3041ca7db6c388a091df6d53d7e3fafff0989d4ba154eb8bb360cc6be3e181e04ee206e37584139a6a127ab7c4e471d7c4d54a41c2829b655453c61738d4df9d441016cc798b46ba7192f64d645685b29a4f17a7ac8e312a10299f675107d2f909988875fbeb88c2f57e5fda9fae4ac263ca4de3a6c0ce5f8cac0a15e679275ffc8599938472b6b10f85992c0d24bc8e80f21ac1dee326b12da0101fecbcefd143ef66572c8cbf27c909e4c8d8a7dab8157190c20a89f4ec1513048f3fc95caedabc438791d7ab00d4ed9236960a4a97495970db7b7096d8cb631921f3c6a8267e15a7daf999361c27664debb2e74527b0a03dbf1ea455d6a0ba18b9bec44944a42e487f58f30c296275ec2142ad2c08b4295e2fc93f3cb7301b106bc86456879b92ab294dc554254c7428e2fbb1ecba91f5913ebc39ecb7b80c322f345f4f638ef821773b7ab62016ceb290984c7a5b5f1bb90262054b0479e61d3de66d9c15b84b06dc077c8ebd8347d41d3f32fed40dc2c9110f5b3786582d0c7c89889177ec8621404ca15eef4d01bab550cdc3bbc79a1b677bdc2a67a6741d9c9b29fee14286dde980ed42757707410f284c40d02db683d76119ca6538a044f0ee03a73f468c7f0a9428c8424719bf8827371442eb8d2e5817fd2cee49b9cc21085d87c53be408046a947f5c2eafb010c1ba42f630860bc5819ec20318aec200b7e5889452b96217421ad72d5a865e523d0d407e231aef7b8adfc5772cf830604d27331f4961e2d3fe36d31fc7176aefe6a6b9fa5832cdafdfdf63a0ae5e620d8af3140baea0912ed0bb7e83f35154ed58a5ce7b020b5d4e75879df86f7cdf8b097df955dfebd55b26f824a5d872357d2cc1db366a34736f3e2496f0c94b5bd2356bd0ecf2ad7a640db31572bd1a6e5ace999755bea05f6a251be565e5366fe40d35333eb0fa65b1bab32354246e1d8c6945018728a4bb372e745ec67ba46718642166a12e4df3a8a60c4bbe2c30857735a3dd886d1e6a37bda0058d7e8b6edd13fb726a228773fab9b1117ddca9a9820889fec9e2acbafa28da3fda100a237231a66a2971854a460643c75c56d26c9312b31055d324e30ed4fa54be4b853cb9d664dafcbb387b0347b272f34b96602d0282d292dc0a311b36c1b926638a42ab3bff8ba7dba517b5dd8bc895231a64740434b36d8dcc897690b134c6c6a6384ca63f12875b323ae3b2d364a19dbfe128109e9632d809377ea83886a759fe5641c14f7932ab3e129699555c215c68f894e84545ccb3a043a794d6a34840fcfce9f372a9c7cf436845263f8b6a900b3c97008be690160e30d401a578828975b90f6b1d2518cc31d91ea0f8aff6ac00ae1267ce45795a7bedb1565e914f081c0b82d05b66017c1d0023b81e6105e1d8e6fee6e1b6b5f30e08852499ba1283378ee307ad3650603f7aa0a2b7729170aaff097e12a264d9a6b0fada0a89ed91f96c03867692b15367f5f0db1b31176dcbce22a73d5c840443de231dfb138bccd9c1af4a700fdc8657a7b06a64d9e9a67d013e546db205ccef15adf279b912471dc56d4742b1a75a9f2d0216d3c162dc7160149945bd9034c1452e8279e682d8a02c9f56dabe3ae89ddf8c16bc4083e5e9ff5c0e24db46040bcdbd79c7f8eb573ecc1abf8b6c1d12ef0000688398d383a4849a7bca95b5f5bebbcda9b1655f42f3423154d48d79b59778f0df60dd9e588719f98012e40dbb88d8eec805943d37682a1ea9413e904494f1784cd3b7b4e868dc3fac636662ca1543ba6a82554226f987bd3c53547a320b8a9440edc4b09dbf7f5b255790d60363cb783f6e46fb2835d6d3288ec155efeb2b2ec326ae9543c5809703994ed114ccb47afbf749197e61e1db6c30379742ec78ef541fe035ca6919f33634fd203c5b18cb2d7b6be8261409e5e5638a5cc5689496c23fb873108226a18543210131109bca9706bde2751ae6d4c98b87795623c4e1765e0d3e575467feb9fdc37bd97d90bbb07da6fca3e4b51a7968438bb7b0247f287eb1c0931c4edfd03abdb5b8ae7ee8426442ecb8acc515438bc062f099077a7aecdb2d1fe048ca60e3fa373aaf777da1ea88399af2878cf37ccf3cde81df433f561164091eec111191eaa4f6fc1caea57a56c5526031a2a8e3500898280e0c7fa78d68444c19ddd5923b43ab066bf3eb9a82bbe1d0446a425525f81109f4cf1c834a43e8acabc79cc1cd4c140d533c39b5bc0bd3d1b765866232410017efc9d462467bbc1740a8586180ae8b67adfaef11d49099722687f90f2960f407eb84432f60c7f9a62fa351740f2d1800e79e8c1d267a0d216d4b2c481b9e07fed83e2e8f144999a163c93ec6810460acc4ed44d2018f539e24ec91666c50b2d5ac083ebeaad43a00ff6948fed450e86436fa2d8a9a931b14e65bd952a88b0da193529a2d26a41d15167589e6f51996ae77add23255e02c0e779d18bf928b96b60d23d0d360d6168a60f4da31d856975bc5a2c18044ce71c617601626cfcd39ef5580ff7bc116a6e9fa794e96eb9cdd2cb6733b2b12dbd62cf2858933d644b9560f6903bc42d2f9baf01ef1c9b5b4c6273a42c164c543652c1a5cda201a0f8d4f4b34dbeaed5eab663fd36c8829e080b625f3fe978599e80ee19d50d70ce7056dadc7c764bb5a9f99578589488a4b702030986e8232c9a2edf4f022d62aa15bc4f60c6977f840fc0ad1ba1fee3e984977073481d20d9f567fdb3458f70e91d6e052955df423cf787f8e578c96405b9da555a4040a342676e163a8c2a902f21e7e3acfd47cdbf3aac8e8eef9e30492e2245b940bff0888768be71dd9b0c1f732854e41b7f5013081a70b59d7d17c0b99ce6390b434ad9c4e30293e32ba2744241073d4f9d20413a10e1183864e46d2029f5e66fc4c22cc2b7b8af926256cc8d5257196c28e7ba1abf78cbc083a647ea82212c8bec91ddfdb82dcb035798aeae815ac83db0229ae695a59a578dd97c6aff12ed7f8d48b67bfa91eb2e548b5bcf97b854a644d0b6dae100674dae0388d115a0e9d6cbfcc6aa14eafe6141c3eabf710d688845b36be533d41e767e9aff3517df9599910b642b66300fe53e5f219365a89f4cf54e947b6203780d847633c916c6a0e5f4a64dc17a7ca255d5df4bc1119c38dee09f873693a0ae71179d38dfb8d58400524e742d83831c7379eb8d1c5f5ad04c342077a78a9db6153420954158035a10c767e853c773d22176b570f7b14604df4963f6dc456de45a0a057bf15ae733efb97f11018b873e02ee50831c603382429efee874eb15a9bc8da19e1ed7b791be9f62d30a3d7fc160e6cea9c530c0eeba0631373bb18845e41f1ec99154e14514a954c2f03e592caf97fa889a11b4fdad83e52957a3ef0019e3da860a6b7695e40e75317838f85a0bb1162ba7b6fe0c106618e781e36ae1b68888af697e06431038b8f0104be61bbc887e169109747e421b716b86fd8139932ad56cf494fcbe728c366d2f49f86f1400c87dc20f342104e0240dcd7a4ed8832f5f6c69a8ee57dcb9e9fe1fc0997f1d6722ce86350c9e5b965a051b7546238a620fe321a135c51529dfa01de0e18b386b7903696900214c4486593a001a54693ad96e0747a5eefda382bd22ece79bd546405e37e8a5e864e2f0f22cfb599ed0dc3d2cd2ae12f592c01f2a6f34a94f3cbb21bf83390fc87e4964642151b7f6b534ca4c2f51134f79e41effc8573d007a6f0d008e6e0bc579ceacae43855f05cdcd5981ca1e83b79d95b9e512855547f8b6b5cc52db4f3f7693466b61c79ed52d2443f222dd7a7f4a08d9ced301f58cf77d7e5acb912c3b303fe5f19b3c0e50f48790bf7efc24a53f4a00894309f8b485117fdd9f4ea76a526854acc3fc4a14ee089aed1e138d9cebe3fc6716f7d6fbece8076a879de8958a0d1b223e78f8f97a57ad1142868ea820fc72fecbfab0146eadc5f0f65c945079280bd9baed3bdc10847d5dae076588c627089c53aac24a594b8360e251b33ba8c08ec943c2a06ca9079f2666c480be1d550e0dbe037510ba6fb19597a3fd2ea35cb599bbef2e3f947db5ac3102d6de622d10ca149ac1be234415969264cd6e607a85dcb2cd8eee3bee7af9855968d12a9def4079cdb174299b9acfb9a2e12a4a8c129e58100ebedbfe07acd37597e6245ab02e783bce205a53e5904dc2203ebc7c93487af651de045516085b38863f91615fc6d1468496746fcc4979e6a9ac0107fa35f929b104c1a7fcf518c1f27a023d61ff2c18e282bea1c0cb0a0158cb4d6a80f6a37158cfecebac1c744d8c1e1d5ea54efa3ec7ac3fdd2ff4111c94e3f6f02ffb62d78c78f97ea55d990cdcf4d12b52a253d2cbe3f235e20ee97cf1dfa74542e5ea5102315ee52c20ce25e624e992de20e97969ec1278e9d3e99286f2983705455ac7b8f39017b4af3ad38bc4a5a482fa23c21a77560900150c3a09d2abf6659d65f025fcf28f5f34e8b3c7ea032e35e8641c268c0e262bbf426c664f2323aa4ea5a681f9a3c28596a7f8d2a744358947d92850ff5d848dd6a096a958d97dfd8871963004b0ba542c1d5464ba5f64e3b604c7625457f0024fd5cc5aa2c12a4655a79f006da5245434f1b4875b2b9ff029a9db484f09bf05d734a19bca7cffdf7a53d0b064bfd06be05037faf05c5a5ef8ed1a246dea2ece1bedc1d65d11e76706d092462f2d478ce8ec1b31bce8eb18d2734539887d025704599b7884a226a29f059049291d4c423581f9ab7fd3fd63a49336b6330ef3cc6df20ec48838a2f59b3d09db37610e1bfdc639d9c99728bc1a40edddcbd85f6619e063ed565a499f9e5988e2b017b6f3207481966f67c4bec08381014b2a6bbea1924496b5c760959e2ed66c8656ae7be2b454561ee846118ed040e3dec2aed3b4a0b4abb9e15fa3bbee8be7efcc05c7b6d4c8120abfa81bd1c67eafa4d719baae6278368d3512f587cc645462a33379b7c7198aa9bfa10c1343d884552fe65c451313982c4c6731e46a39488753a2dcdf988ae17f594c46f29076a94f14e9f03b68e9b70531c37dbd34f8cde993c01bef724b21e0f5a50f6cfa9ddc7a12bb40395443e4e609ec9828c1e5b5603e9551115d05662389819750e540d54c23ca9934142eec23f5280a848a74e33eb99249195b7c2f6ed3163164df0914c14801131ce680865a910421d602295a34c463aa2ef567efca020976c54e6a2231339967ef685ae1ce18b7ad58538f70048b5f131c8a875c93a7259f347a63d3bd46db69657d65d9eedd91629679c5067675cc0229ee57723ea81f74415527501df3df03c3275d24b63c5d54c20d1e4b2c05e40be63e1698b898c4c10d9f4b146a3cd8cee90ae2f5c163b60319edff61cda3391f4168f66017bee26c854a558c57fcb8dd85d3773cc353049b8f49e22783e32eae73ac3d385c69e973c164818ef4aa74623ae5417374bbe9ef33cb3d5c00c08ef3ad6ca6d5a39be80a90c9c531e8c3b75a5928a662024ad722e627c463d8dbb03d5fbb0087516a646eb35eccdd186ae192dae4acac6d74f46c6556b0a2c1f649ec2bec2020401549c8e62ba3cbf6e0c93db792380339f141e752ba7d27dfbe1c5412ed055e57595ba7b0d8ca0b6bb3ca602bddda0242dd4a1585d9fc5aff0e8ce1a6c343066bd735a81f885dd38d1da1186355346eb60ab45a10fd2acab24a72cde94ba846c31d12bd207928fdb40c2514afb7bea29e1c71a3dc0a016c0bb28f2073bda448af3088a0f165005f788e1ee848196e48d018d662d0bdc444c072d2be6be42889c607ad0f54018e521df2b8cc8f9194a95b883a823beea1beaac37d99ff046a19e0566f1d2ab9e28965c999040dca097daa902f1708717fa780122aa9cb087ee504853154e26ca3fad690c033b15a78f77ce6d5b5561d0ca8cb372725f88f5c1439859a06d90c84f8a160bbd526777f2cd24983f7d5f5089d8c63af59920f64f7b93a339980d3d155b2d44a441dff9ecee0cb173f87b39c271d3c754fa8eb2e60ed3810d9db315819724d2524439da8e176e40a3c7190e944dabebcadc3c948f40b23a3f0dd4d64f8b240dd0e8bc2012557e049439336f36ae247347b81cc71a6211c47ad8e6eb0aa4404cca4c6b8e47b7f8141035b0c91f959bf452cdd8b8c3b14221a97f68f7f4c8c0e210a25d9ae9be46229ed29db287efd5a455af90278514b"
        )
        val state1 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, waitForChannelReady, TestConstants.Bob.nodeParams)
        assertIs<WaitForChannelReady>(state1)
        assertEquals(state1.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state1.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val normal = Hex.decode(
            "dfaf51f72e8f5f45da6d61c97718d5246a83c9274442dcb5487c50eadaec418e7b9a074cd9eea4430793c5cf341b11ff28e055b0c22e5d47d4a4a5e8870fef8ba77aab82e50f6796639c55957745275ff9e2288bd705c3b67227753f03609161398cfbd673137bb89a1ff637517418406cde62b070065d49d9706b82dc78e55cb06d6c42a2b910396aa180475d89e663c7239f5bcdcde39e910d10840f343f59bb7ae9474fc72ca76187151805a6558b43c1e286dcb623a616e1fc13625bd8b7eb228aefb653b615294b997e889d283e241ba80c597bd26562790e8f50da6751113e3cdf04236c51f6411bd1012cdd586a5113e7ded3df3465d3eed9ff3ee5c4c0c16ed75f7b09b3cf06c36bd0d7346c7ad5566d4a7775be65678094d3fac39423f88ac815db8330b414ea15bf62a15a67ae9e83f222e62f0edb61eac5fec9dc797f7f9a84c67bd6298b22a6d0a0d3f38e321dc22e87a9dbcf57ef48a083326d84e71259da3f1d12d181bc39b4b4a54e3d68abd577bef615cf81b40a06c0647d01d0ddc8ee7776a86965ab9dde9339894ae62d1139d98f44d06e7b19166c521968cfd959eab9ffb6d329adba7f177c6e036c1df4596e0081bf53dba62b81ee970eb66a6f601cbe3c7b5555a43aa7d58662eea7c59d5f60889f4f3572be470f6f006d4dcd6360e1c249d2365b6146fd5f8e6e9d3c6be34d9b1ea96a078e0a870e4340593cc5aa930687f2f63fccb0e9cd03687a1b5cc6e96f7833424d2727e65d8e241070fae49be96530c7e453c68e6a8b0876a36788b6d23c31138c872ddf114599287d8f8b096fac415900abd5b9dbf6be14a76e88fc971167fac10010e5c65e52a19a2fb672f7b45edab91ffae9a1cf295640883a2e5e8f4ec23830777415199c30068d38f094cdbc5f3037d3b4239a1a3003ce61ea86535d27d9bf2e866f5b08b1f38d3b54751619496a0e9cda8622dc92a9f55e33e5210d0862ae3fca07adc448388a6e751be68643c8e2aaa9adcfad38efc8b91408cc6e37d63d8275b1b427c0b33b6003aa750408bb2d9bcc187b291bd83103042d9c57ac473e324fd7bbb204beaf96439317d169ca8e8ad2a6bde2c0ee7d6e4c75d76faeb345c16066745f33054400bef5a8d0b52b9f80475d9a58a002ea1f6d565e17a2c95a6ab67dc955cfa1a1784440297fbdbd5eeb2daf60a43bef35fee86c65f878fa1cf7a51fd496d556527975eeb00a2d12c7a544a1f198cc708eaeb3ec57c3cc1785ab3fd6f4c488ba875f893ded29cfbcddbf1eb6098471e8c34ec93220c95cc452a3560e34dbab16b71e24b2136aae60314573ddd17ae3e69b6d14d52f0adcf22427655750e26da4256bb2ef8c841afcdf49d9d738316573fea02dacbeee798aa7e21d2a3ff16b4db51e807c97cd148c02f1b460fb9a200b91bb541cc29ce26b11b5b73f8c3e76a9ab33c3e54772700402047b3ad0cbed07a4877f270c78e3a666dce59090e61a93c3c0d38189077889103f7411d9b15d2a2989b32d9e0c5667d9cf6a54b8c9dfde77c2cfa42421972289113907dd7ca27ca9c9bb97100b57f2b0ae5ae4bf64101374cbf5cd27f4f5abb5260d95bbf8d2a71c96b052888ef728033acabcf2cab499005d38da1d00f0b2f9b8b52d09e7e14eb86b15fb9dbc883284b323f510417b662debb33a1ea27d1052004b204aba2eefb9e7934e1b501a9219d7849d006c12a4c0fc1612216d358c71ab7412048f46eaa49c24ef48a879220038fcdbf3521fdc6d01604b66b74d8ecb763217dd66a6bd875bbf8db92ce9583fc2c203641b991ca5b35982d27d142f3570059896e49e2cec39c0f055b73f10029ab13a898074d77847294e9454718969df866f0b7b324397e91bfe30566a159d08ced28ccf2fe1a62faf5b061cb3fc6736a4cd6dbcb7bd0ae2061ecef7f230bd010362910eb9dd8947bbcce5ebc82cedeeb843dd9597c5c150eceaf5176dc0f8905a2cd4f1d54fd6fc56d2404d7ff15fa5598dcbca97bb07a1e0954b63ffb8165e866cb9bb37c712dced004c1b2c4b42768f17b39efa44b0d5427952f3e33e5bb04223ba237ec4d9b2027a270f4842de9a1c22f589944a5674adc5f6cdde9f103d315f28e1752c4b92e40d325a9d787c14f03d4db7502c58b579f7f9ad758e454604b3b1521194f068cb43b37888604b016232699f38373c514cc1f2a26939b4066db773700452ee547635b7a46a412d749cac9017405f43b767be29e4d51d20250d4df97f02d0f793e00bf8c4c70a39e3a047f306e784b69d2b20b398773ee78a5d937bd35bf682fb77c79719a44c5f26c8b5974bf501ac4b7584c2f84402215632a88de0a1b17c2608e964e80adc7daf0e10fc0e6db0ee954fb47e18e3a8fe436b2744686f35ea08438d2d558bbdd9630bea7d3949a3a1c9721ec665a4422e2e58eb8cfe371aed75fe446b644262446ddbdacd342ac57e55e7e9558753aba8067c3c1f74e73a5bba1b6f174b573ceebea672f44ffd4271c47e9f1f0f622b279e4106f02206b200a27f962d94eb4a9047d051f8f60b1f18684603431789e3619a9c6227959ea7d5cb2b67e006fcf9d0273ba20b1fb94274cb7f7062b39ef856763e5bec5120cfe80e64df6c8c8e22548b4a6f833a02b42a3bd3b324d93bc013218e2eaf28f685885d75dc63f312bd544c6a9106fd5cbe66c59ebddfd0a6b827ececd980abd17580763cf8b080f3d3a84532931e389230e2d95a41176f4af3204d6b82f09cbe0070ff3e8cbbd3f023a6eac5d146a1167bae5713c8b2d7073475b42693dbbb3a0495b26157fc650527c03ecd5ac2f3007d65640f8107ce92bea83bdb5e7bf403649a8105bab27a035409e71c4a8ab660277bc3c62df70651ec1111607625d995b7f1cb152378c111625e109beed927d1b15ea62cf1fca78899a50dc0110a10507f80af111b7d16b8c88abf8625fb20021768baa193728eee03d9c217685f6b6ff482ccc9e24e291aeaab335201aee7c1aa54eab8bc552850465ff8d8ff18abd02335c3eef109332a95099288b40d83967727075522c1db8699b490cb73366d56702418ed8dd97cebe506707fa4c51844b84dc24f1b48b5ebe603e8ccaf715a7f686bf6fb6b45af7841aa5bc8c7f5814a79a533f946f7e6368cfd099047d771c076fa8dd671b782a46ef662df3a8b7c2b3de2f1486a2445230d0699ae4e4517f7411aa0570e0c714f5ca5d25e953eacb48614ae76e4bb2085d4bb65ebd36bd580317aee8836443181f56d4945692852d361bf4f127928dca1736c6d55d1b4959ba46567f10477b2dee9fba9738bb764bd29b9a0c3a57474502144ae59228ad177422a9aa919f30395c138a45a0b084b2ec152e23432088a395dfe2a5c1668c2f587108e88effb658961794d3c97948607939cb5edee65f20ea173487a047d48a77b9354105ec299fc5ea2e50684a3311d6b6c8c9b4010e5dd29d4be5b41e15a1284a2b75f85fa6919bb0405a89ef67ec00dbc6eaa99dc6c96c1a4eb386e9fe4d3d4f62ad611df37b27625575226253d4ecff8c79e06839b42dedbf880da4b98bf4f73315c3a3aeb3e278a52c30589082fcd30f39794e618566b5fabbfcc4f79cf38b2a1620909fee1c6dd4039ddeb8240d2afe30b8176f7a3dc43965e57297a50d9e57b6a5187377557fd8c2feb7a08ec3dc9fb83dae515cffeb68b4d621fb59246bff580dc75c859695f8f58775f8765c36482094047c671b65cb8cb0059216d9055b2b49f8a37e993bde051f44a33fe7c30930ad9c7c65d8b098e7cf3704a0d4c80cd0d88fef50e2db043906db853e02a534ccc89cb800dbc13d354636dac2468cbc383a41312ccd6605f2d025df64f0616f0faba3f0454ef198d69b9c55bdd84c2d43e8ee29439278c31dad42aeed79a019bdcdb91137e58cd12d2f5f58eb93b8986f4d68087012ae003020ac3d9e4bb963a9c1df37f107acee2b4c1bd0d4d09e89235d62174c5e05643d08ce671ac7bc1f17f3f8013ef89478f76d4495373f9d61d0e196925a8b1174f67baaced932d48bdbff33da00f35e6d4ef7d3a7aa32f5338f7951bffacc4ab8e1879d202b02d6c2e2e725814b007119dbed09a2761f8c0a4c29ea2488b7ed2bac66a5d7864d57c86a2a9c4505f40ea44289aee9d5456d554703c95e118f0f2c904f3de901b3f3071c7b17ea22d79969d792f983d3fae46d008b6f99adcc0b761cf62c853da2fcf93185e9f390566cc5bafbb316a13458a88f456e064074ef75ccff9a4448e2bd9797d6a5435407868651b4e3685d9b395f16e1881160625527fe263eb10faa56d7e11e08298d6748dbff8b96ef8a431e1f188bdc8eb041cd6f03bbef8c610e6e3acde630de4082c5e522f8ee86fc8cea81923e9fd616c0a1559cb61af896c9a73443456ed7cae8fc2500add7480dab119593c8a562ec9cff2719a30ff80a0dfb455430cf4880cd82dcf0a03369001e38d5e4df1da704ceda225f28ed6026362b23b79ab19a5126ef115186e5d8b82dae449217d55723b7610b2b1d5d084528bf62ae927e43e2dea34c0fd76b40f9b6bfdc033ccaf071bf780026e370d2c3340017d8b63985dd20e9b10b44f386576f816c3767540fc60fa209ead740b32dc50ac5b5b0faf914a538b1e75504a22a2f490efceed89e16ea605c7b85d6cd770d11190cfcc82becc8a40b1185e1a60a72a2737b86441dcec56636c900b3413c15a7825ea6cb6958e67c9474f8138d4de3b59f27357fca9846d3ad2a9a45c1ae4273a3331b85f46aa8ab20d0506b18a4c3d1bd2d77666eecd5921923a56f8790f1d56cb956d6d141403e2635649a7b430e4383054b089a7b45db6d2d786ab5b9155742983b9c28da7485a6181ba285309703006917f31251db7b1b2fbb84e991ca4d0cfd6cadc8ec417aaa24ff47b3c7fac189bdf203bf72932f4666d65e73ff37b46dfb3fa3248a5466deaa3629f15b85b257f5b47813539d15a727d4e68c7814720349ef036f42f10515949f830b10f89019005572c8a8a4d4aee61c0919f57bf8dd764a4138750b334518d551e0abcd88b8db2395cfd85d389394decdb8da7a03b0963ee3734c68c764b6c045bf0e960da717f724dcc58f03831439bf8e8663b563859c7f1091ded187eb2aaafee925a86e20c0b8d68c7788eee8a3e4e3dde2c0793d2ac3c2795f70e65cf85501b72c34b12358e9d2958ef69f2df8cefe3f09e0d82d3ca48d3b84720d69c31a3a2d067686a7727070ea7eec6701e9d29b9c25aa4fca106700c83c48346856bd6d52e0e0bd9be549ee58e8423173ee82f56ae8cd02c4c0e558fe28693a6f918f65cf2f19cdc8175b83f3d1721be7eec88ba42e6339d8a41dd1034272719383900fbd1a76ab663bb498aceab1848c29f73"
        )
        val state2 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, normal, TestConstants.Bob.nodeParams)
        assertIs<Normal>(state2)
        assertEquals(state2.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state2.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val normalWithHtlcs = Hex.decode(
            "39146e0c04a9ea101e447391cb7c6a3387e7b2acb76d0246a386dad319576d3c821a345995cdeb2a51fc41172b31a863930ffba48b735877942a88561fcb75b67f3d0be934610ff5e336c985f8c3a3784af26715c86e4bd965b02c455f391add8c0419ce8ca0406eed37afa4f0362c443ef3a3c00999d9798ac002232da7f821ddaf0693b6f33cf7289a272d2d4dd4500b14c3968fea66bc67df9840d4602285f9d868d282cfe943f2bff2f8c4bfed5f50b5b615920084e57c0f76cbb205f7981563dfabb8e4b721a08403c4022caa33f1373ed654cb3d7703bd65c29fa6b051282fdaabe4b98bf758bd8b84019357da48b143112a60285da991f0e12b68bcef6d58e0d0db3820f3386b2c1e594f28af24d60f5720de3e13581cba02360f2e704e5b49a8ffcf322f199bbfa217f80a1f0a2a610fe55254a9ae4bea09dff32bb7ce42d93ed7945294bdf379d427420f578f329612af5ae7ccde161b87e7fb9bb984d740e2409a3ec8b9661172f11fafbb7efc7b21c05cdb1bf845bbd52279235c1b8788be2c09599a39f46739395d9a8d733ef8f228f20cd5bd03b12b59589a794d263e0ddd331e775d0feed14ebeca5775a1ca81763ee4b62d74f5d50f9c2d07ef7bc4fb737092fc1aa1cc3039121248e350e563eb5691606421d6ce78a5dbd223576906f7122c810d35945de54dcbd5dcaa845b3f35bb6e44bfb4f251056c41f4c211de2caccbeed24599326f634a5f42e4d9521fcc996e53970c1e013480bebe83810ab55f3792ef08d3bf45b66bae10f96b7fbc44272738cb57f662d67a2a9cd09118a4b5c886de2625a226bf963e7fb6cf786f7c604515914ca665552c3c52be41dd912f502dab4f35a6035a28be47abcefaf975db31eae23c095e60fba37ca010c61ec8d909ad5f2fed6b158411f8ef4b0e29f8acaeefeb0b19d8b4bfca29e5c96df36639273c3a3626236b48a69913ac049cd373d910779db557822126af68604fd5cdafcde5a0e6b923451ec34887c600fb1f676350eb51b20fd535a424b845bac7f38466e4d07d9f33d7f1ea359e8083d656584ae7bbb088695abddc06b0b47047e21ef325de521e143eceffba4c0a5137670dc1562e31641d91614aa0c8f57a12f96033779ad45ed1ac43eb001db183d941364ceae5e8f118151cca6554a0c639cbdbdefb3182296e23151d02967dc33845faf58df6e8747049986e6b0e7f2dc0411a4782b79be886df5cbde343c8813e534ac1779469fbf98aafbdf308ca5780e472cedb8ae34ad49737711c5d6b7be1dd477f3820b7375b84851c10c8c82cc5e5741ca73e38010d5afa6110dfead1a2686cfb07a89065fb1aae1c1cdbe01fa5f53517e4dd45121c8584bb41fc9873d6d826ff9cbde721a16326bbb5a4c17cadaf7b54ec8842d25359ba180830efd78129000b82935afc48a870d29cbc68fbde3f2d73e261f5c27ecb5716aad16d95607b1428df846c08514720b8e4474566485d7e581fe5c2f83ee336adf5b556b2cd244ac3dc480716edb12866b955c1af054f550da7af5e0b33cd8d08ec5ecb01e0a6e89a4390bb8298244bb926ce7d418517d8407a47c0277073509d6c7ee2c4c12ba1ccb37bb28360804dbfadcfd873514281f087fed59bc89f162f7b13a50e770fb01ceffd52545f50acff58ea4fba3aa0a5ed641f9b37aa0805845443b1f3ce635b3cbe7aca1c591efe6db2b9adb4938137e37c1dccf851558755c316fee59122396f997ef55c285ed45c152d3f66440e46942f64706ff8fa4c43937e87c9cc19c36c9adc2a3eec41e39b54365a1e7aea4454864c9ab460d3ac708da080a84dae641a6b05a7b8c3633d7a56a8299a5788ed4badd8603c6da45ecaa43586c38e96cc294bc462a4a025f3ae0b667d8ccae3b4dfb5c6cf02ff687aea1e28ac4448f9708dfeb82dbb184cea1ce1b204e7cc989935749678c0a93819071a92b2db91598befc05a01aae07434d94bcc328b0f689963d4e19fd2c3e7784d64fb09490c8ddd529f056ab61040b81a5a936e4cd0b97f3542ce3123396e3997e9c40d3542f2900ec9728900dc35a2c30aeca1f7ff5709f2a95d2b6bf2bcc80c2802dc832c40836a676fe4088d2973d491cd890150a0219daae133558cae5f54a32a569ed6b18242736457c4af9e01dd710fec46bf8480289c0597b13ab19237c9dd57f98bfb452763083de0416478fac99c754a261d8e2eaabfd188f54fade0d41b69a0064f1c3c8a880492dfc14e46e520997c3a100f31d427f19c332fff70aaed7aab0ee8f8666a0e5c35964a1146ef96b2df319af69af2353fae896d96a31a3c865209c0600a7d306c4c7cdcef8233386013a8b545a9729cb9d584bb1bbde4afd75fd0f62de8cda44cd6d159db24a21e69435c55e9b58a56026478a36c079a88781014a843cca2d6fa5ce481728c857e130a1b45e3da4007c6a840b4af4bc84fedde3901b86a03242a839cfa1c38414a4b0b0af1373fd8695fb868601abb2df12ee2b83b0a195e71e0ea90640d8182f38fad3fe2ed42ff2b4518405d657ab2a96f60090b3335e15e77e0bfaa1e275271cc29fc9f52416dcfb5f82067ec95bbc751c67d57c64e01ecd1bb0bfc0f8fe6f12f15c750725bfce09ce903e105f6389421858b66145e22b86a6fff88eaa222169b849a1727b5f1b5e57b9e1bb16c18de29b4f08aa530a735ed7c9ba56757e5864677f5e50c47de6f9e39b16a67e5d6c8c072a621972297704f6c85b3af9d63096a6ee00731933a5c36c06c5eca0c4b4baa93e67bb9396a79734a64d71f3ec98790742208ec11791bc1cf0bb58b4fd28b324f5c6ccbddd05c596d25f8c2d1db3ddddec7bb254a2b78779e7b3c9b833bcbf1f9d7f05897717cd8006234ff90717058a5b1288a1b5c576143e15fee1a2c99a6d3a8de5dffd88092e7fe0986d799e220939e5e0a3c8b02c000f7ea99c8c542fdd4104f55208261744dd5b6902a110afe23461abad87220a6c5a402c9b04e2e0ca2912023709ac05dab1ae823bc512919101cdc58d92f47f91aa58a5b034bbf342591efa50d0aa3272fd60f6d8e3ffa1d552a5f24690ba7df7e1003c077a4c0ed59b67376fdda1e705b1fd1add82c4cee230a5fcdc9429492edf1f0b8fde09d652a02db1533527a0e81463769bec0026cabe04f1b1cfe14187a37b1ef34657f4ef621657f1c03f6b41e05f67a97b728966a33fbe7219730111f7bdcd7d45bcaa491783d5b912d481eba272cf523af8133eda3b4537a6bf11c58af30c5e7dc2fad147ec59ae03a85347b72626deed6518bf40eb193f184b58eb362bdd86f984d5b6b16922a48ae3de2c619b25a7fc2a5dced2625385dcc956a854458517f754e3c81a761b84c04c87f2a3bb1ea84b940b99318ce23cd5c3713feb49fe3414746d93a9d5482057f83bd10c54cbd623b9bf3dd3ca6392d7967361f2e21dda151b239533e28ecc6a843747fd18276c5958b689d705d30492c5f86ff70f7d9a04dea0abae0c1bb2c1763b5189d7c5a0bfbf92be5c9def410a2634bed70f9533e527ca6e34598cee970a3b2cde7ae9c54ea92674203c299ae4913d33a6fed74ae2ed5e40922da205200729e20d2670b2718ecc14cc2e3da67912f115955bede723748e395b8b7218d07c5c5a02e27b16fef4edae8a76e1a5a67d63669f1321bb2f01f8b423954444b96e83568f8c1d63282c783aac91967653fb1aaa6b417352ce504cfc2c30f3fdd051359e8a8965c08621d88b7b5f17f40fb12d7d6bd38c5fdb0aa574a4caa344d10cf2d8efb6bfbc997eebd964504ef93383fce946b041e3b6a21a2b048de9bc4bbb3a8eec23e71fccc43cb048831fa6cd343c979093f1f4d3f050bd45d1d675f4040b1592723dcb4156d4663ad20e0a10c5d7b49e5dc48131ba8ae587b3532bf11bfc01140610ac09a2a93cd01b2ac5c29372332d9e79837bc196d247a91c619118159103ce3600fe77b8609416d7068a1e1a03cdb71f52016699c7469541efcf925d68ebd8ae3bd6be93b8960da3865df03e51a547c3e75b21de80c8c1eaede7b38b01b2cd6bf8782d9240252c2a88a16ebc681ed74f1fa585766b1eeee918e2e4b4215037bcc8631d6837094225971423d5a87a121b60d1513ec183b857ea0bfd7c05aacdbc3817188e213144638af3a6c299338b11f3aa22c24538525db72250fff4fccac6ed7d5b1450c31bee92e20336998a87db89fea3328f632424b4738ce3fe0a3126039b81af1699d5167c046ac117639218f32488f7fba69b0f810f8739541ccc6ef91dba06710493ac4410c155f98c0f7d99f666ca748fbea98b40efd694a1e364bdcf51403badfe0c09790640be0ee2f02910170d839d397ca135816f7172c9bc46feb513b7c537312cd920817bfdadce6e4e5f6ede0b145d64c9e6c940cef59cbb3035e808865b93c5fb2ff372b87a7d58d4224ecd01f82cac62c978ed4552137c64639f308fceb7c0365da4d78caca2e0df04f16b1f29893c4069593897a061496b7a97f919cf9ea38ee115a92e385248467e42f55e2eb27269984e028981650bf0f0ef7038ba5a4affb70461a6b5bfa7c68fc5eb987ff7718ea14d2c17c8e8464c36f3b0ddf9d018069324fbca5d8dbe7623f809ced94d1adcf4274a5ed6b9c5149c2f921198ccdad529094b706064bac0503636932a10ad6e602a8e7774a39058d6c2874da3035b6cc3f37963470cc5b38b83f8e23a71660ca5f5630c9f9b51e2c101c4fdc18ca2b1213ced458e51bb7d4de91a90356c64c470053a1d73edd39ab3f7abbc2d9fb9688f4f01764e9eb20cb7204029341ce84a93ed509bbb2c90bff0257c849da643837be5dc17eceb43a68f4a40731a1eb0742a8c141cb52de113a10f76ed9d6b3b1fd8e1f5bc2e77072c63e0b261e1264d4c17bd4dbab81083e59fa0e5a34dc4fdc00efc43f33918d2fdd82c691ceea73f862229653de6d478e8486b003301e765fdb21bd9d37145d872df097da8dc341322788773fbff44d7d7144ed3664259ae610b322f05cb5ad54522c49a7020a055629eed3c1495e23ed4cb061a30b4bd632e8503d55e6802657323d2447e6b91a682e6f0ba3ce2d4b71f5430e845958aaa45680735c6c3ee5303fa56211c7aaa6fb67134354b02b005a96328c66f57528c572d4b7b0c90f733f390f058b88360ae96d56a859e72b810831411695b03819fe0034fec8cef3a26f456e3ce8144863312441a592a6e77ba47e53518f77970e8be72138b40fe0a895198436d6f39b4718ac96fe041bca12997f1ae07917bd5774a7250cdf8a5d6d8dd73ee8ea3646095120da1754fdd1d4c7a5f945bfd7fd568671d6f3bfcbc52e2ff15c23dcf5a19fa20c4b565d3deabacfc2138851f0121d55328f280209cc6d5b67c2ffb85efb337a0d6a2b3851dfe7099e0095fc63318ec23110a09f964caec9c0b757559a12bf90553b41efbf4a77329860769807c6b4b00427f21b55581e0cec517885da8cf868945f741a75d9222e52c0f94a5c7b5b23402b72204cfde3edcb1769a074a0af7e20cbd6b4543ceb53e42c8aa1dec9c5045e6676538c9230f374f1a0c0ffbdef3fab55262173db6d3dc3e54f2d39e44e6360e20a1d8d44e9eb08df2bf550810c72e46fa1cf2080cd849ae1e4fbd3e6e6a7f8bcd2473ad9ca0ec7462476444e852d6a0f776b5dc2934f79feef282b72c8fd876ba6e5eb40a595b3cd37a9882de49091745771c00ec6621bf64f1bd43a0a07679d9278739415f7d9f0b86c3d9bd489ee5f229e17f7e5b2adcd70ada3b2116508abecefd0db9467d8f5b4e72d1f1916b4d8ce7457782a3b16dd26033929bfd28df6a5b8cde37b443db8779dddf3948a84405bdad41c7355d4a8dc95e4bd97260e4c42dfa4d63a9633f52bed746a50e81afa9843431558e228a66b30b989f5d4c6086d2dc96b450ba257d79ad1bfd0c418958bd18a002eb30ff9802947afb2b6b6b1608d74b531514d556cc5d00e3620fa6fa40071e4584308b36561314507286d12e5047fa07d6c5fd6728864640f7ee2336936e9393270e81ed0117708376ba4a019e1f8e36eb6bee785ea00519bcef9c436170b8cb52dc9498302b3537f163baa36725f0cef5eddd864a88842c1a626745b47da89aea297d2484a2aba5a44d07cd7faf848c8f00dcadb8410f2cc54412a096dd03f4982f554c5e11a882dcf66d97ee0854ad6bbaa2431acea1e2f7651f3675271c85c93cf257c7a984beddd990a8eca764089e44c4e764cb50b0ac0acc46c7fd1c1ebbc2971edd3acaa52e9dc9283556b22bac380a3d1fb44618a428cd6154fac540e1d5dea3611c3c5d25b43475cf97fa392f5b5b38131a6fe4e4bf6967d0f67db4179a0479f81337c79f32fcf7b426cd0dc90f4331c7967f0ff1c23c4b3da6b716354178947fa09fe033658528083f6e8c1efa9e3426bc74acefbc1bf007051bcc2ce0da41c958c766761b38c3c138cbd1acb2b062f36ef72aa07735ce957f54731809bad74b60657372abb58e52dc35ab21d896224e6462a24419936ac0ec66f75b9f791bfc607c01020fb6a3aea25db430bb353a515957b52ac6eb4e58064842f9523e6e20f2ae12015ea993a569b259af5e2c959fe4b889859f0d6019c9342c9bcb4a80fdd4449a6a0f1fffc02a64acf8ac6e14dff565492981e0a72efbe19e5e0a54dcb82a7f0c9bb218d5efd97ce82f3b9e6e6d9e2d94fa33ac8ea9bcb72f9d1e8f3d9e9c3c7cf7d7009228af459fe0fde5af8dedb2d6ff99ae079580065fef02881c3a5ea3eaf177d50c2ceebaf9ed5f9b2550278d19bf31f6bc0e6f855bd5ac384cf52240aa272a9ad5446f457257b55198546aaede162ce41e486a2128f517cfc2538280e93b13e2004206eed7f3fc62a18a221e2b98bb414eb4c5edefeee834a4e6288c4c02f7ddfa18d791a5beb86daae0da4dea9aed63f4ff3a239060c9fd05b34b8a8f3db16b0921f681e5a5a0ab37250ec42bf383f5dad60bb07a65083328fb6b9f7a3c1d79f33e773d5e05873a2275467838d80a27d3cf5bca962907de8fc9e3c53df9942cb0417c3ae721ac63ea8fe5901dbbfadad8eda4531ab42056bd2b9f7c75d7e9ed89bd20aab26f944e5786d5ea17eb16480bb4a4051c2952f8c5d613c47a11cc2647fe5f6a662e362170aa44566da7c37e8be854822e121beb9102ff6c9a75f19868748c0486204abf4e99cdbef5f7ce41f9fccb8a110a2fa3cda46172c0c2051c7ff2d834914a9ed80d38d6113040b52334431a684faa20f221853c35e5c61423a1a1bdfa601f94b39ffe39a6d796f2c4a1c1dc92b12480802ccbd9f68c3eaacf19566996f9f76513ef48a5dbf369484e0606d69451891199a7ddc108748444b19ee91fda4b6fa3fc10de385116d8b6d2b326b420e6a077f54a0059b2194851ddba864b5133a3ffe24126c873e7194680042be68a74e7db253e7c250f224f07d734f89f01c35e50843ef5015c07170338d770ef32826c4165c95f50633b2bcd44a0da986bd91561350b7d0de2a0fdc5b16c2d47e78736d6e29345f1fa09f78c0ee714a95b81c4ace9566a2f6247ad809c4bbc6a84cc350ca1554f96ac891690ea83dffb3cd558f65c3f0c9150c262e26a4442115afd7278a5d00f50c0bb2b36cd4011a57ff75da4d5365ce11fdb9a8635b7a9fab863c816d40747254380e97da53ac694234b7bd0d39a61afd650b2ca1bc16d9f95e214cefd3d47d3bf22d875738e301b667f3da95c0e2933cc5f7a8394155504e4ccc9122a889802cf44c988a2af9f030972cdcfb2337210a0ee68b939b5701014923e76dde42781ae3eb482766d6e08df8c27746c6e614d19149b144f4b130163585f1469a1b07dc2511f4626ee02cf7e3a9bfbab215a94b5f784596bf260adbf2bc6381043a0a624edeb69c1529e8b66cd480ba7af1871d610f5b970a784202390b23ca23fc078d175d2af26818f57f405950e636e17c172daab819875e8067fbda5d54ee4d725c1aed937dd87a39131d1a0fe5b9e23316d6038130880a480aad2dfae877635baeaac30eb0a3c9f8e003b3029ec03429e40b6c3b4078558526336da3c320752908de86ebd1557a57a49a9c7f7f7e2479608739006549e6be4123c7b74afa78427d761d66ffe66eee39be7e9d2d6004ae7f762315b62a006a7fbbad2c5d86ab3045661f4e9b7fed74b4e507dbd11b6758c4db0b60de47397a5e0fa6601e7b5992551bd9ffbff0e2de6dbfb850809bb4870bd030ce7d32220dc0e9cf7af1a0d5c8b62355ae81552fb0879a0a88e1bb67861ecba5e962250cf21df41a233a7104dce1c0e10d258cf60b51265910757d84a6ea70125183c4c358694e119c36886123ddd7ca553d83f7fdb4aca58b33ab19d04609ff8198cb94188f804be6e8ef8886dbeddb63965199c88a1cc06c63e91c3166c4b1138d8eb15922bea4f2cc4892bb4cf4844e9168f8442e9b07d2c12b0e2197f1992638783f3d1d3d596b7f8788b0b5e24a960aa899dd6d93ed56244cbbe31dbad34b5b77ed564c7847647bfe513e07a46720a7636b9447e8bc20260a722fd5a53376e881fc4d9fa36106a21ba7d273ac4f943e0fc3b0291b86e34d68aa4f65219c733bfb209024fa3bf4603bdb74a63916a78af653aa8d8770fb79fbd7e4d2c8437374daa9a14d8439e439005ddf772e2076b9118130fbe74b8d886bfeb9e8e2f759b8236d954eb5cbe62f8a1fe7e5d76ba1263b5a114590aff0c53da9205f56ca1f2bbbd28e52b540a48ada05681a2633ea4bd615f7e6d3283245fa25a463a9cacfa161f126c2cb247b466a7ffc196210a280f069b15206a2445223938395a06cd19d0f4aa3188f9161a2b64062acb23c23ba829b16c2c79cd5f47ffcf46c025f5888ed2a0bcc6d9aa7329ad93b54e55beda501b5c209a33012843a384b84a86206b0c04d534e1a1bab255985cf05db9f1dd7df36f1debe2bffa798c8c38fdaf10050c8756a6dcfb2db1669b67b45699497d0c68840f4d78a266bcd65c74b7f26f713fc5b3fdc6b3c2e17974ccc751ce96b3331ea3e11c487cf82acbb97330455f9da37d9dfb0fadc92b22096c41b14a8985358574107ce68998c94fac78ae8c5e7e4a83e1a1a79cdee589e5a6598d334854a977054f20e8fe963cce7dedc2e8d4e6d5acc3260b733d7bfd9873107686d9c5bd249b4a65845f68c31cc4b45fec3014968440da2010437345473a656308fe173334ddedf9bc52ae86bf9ff2bd48daacfb7eb8773de51782b5b08bc285dec695e43472571c43f16742496be3237dc281da5d9c307c7f9d0660a250a174a1381734a5ebd70cd896b78323bca7d8bf12248c9a7614a390fd1c1d491ddcc148a1e9d1845ee486af49baa4cd9cd5c28cb102fe8db4ad5c059dabbdd5abd337d7c6b6c74f155a77e88f3516418da89fe339dd4b8ee69cc66badb59999db7b4ebc1940615222a85dcdd2880abd8cfee59c3a5b1f1426f41827ba2e0f6ab84e1a65cfc54b6aeafadd246803faa049d098d9f15da193a0848c53ab36036be30553879af93c2e94cf55792dc60f2f9403c66d8436a9cee4c44bf92d9983d7595bad88590a286be074f1fa67509359cbc6f13f3a6325b71cb4448039fdc51c62239e3ec2e5afb65076445f419ac4bc2b9d01077e84ad7de9d8ab23329f61b67638a23e908643016d96102ebd03606e1a487408ee0ecdf9b347715ea7d6404a767d5efed6f5e31c28dc9031af167e9877e287e7b39f5c7fd0e342c309ba7fd2f74c14a623d8d6d3264c5f61db37b189ce95584d5a64631173628a90ddfee451ae1737ab6969a27273657cfa999c41e26a03a40647632c9bc98a74eb22409693863739c6a1b663503c56730c461e4e39ad8526c671ce310c332398980c9cdffdd78beda589c34979e6617227b8ec7048f20a7b7cb16218b3164704b055a551306ee476ab4409e03647f6a29143d746a98b9a1d8c00bcf035007d228d43a50d89b8142ff5fdec82fb3b469ebdb37424e1c464847a80586f139f7e7e14d8bed5dd7a779b8853c45067c5b6082297f4025ef55598cd4dfc2f44ab34bf0b8b01610cc97707c9d3dd53828ccfa93343279fa1d4aa8e8ea981576cad4bb011102f0463ad78f4711d9673bd84785c1f901662e6a5f7de16861bce01f94c5887abd25ae2e2b95915b055975e9b6b1b260a653314be1ca0014da0fea526c57f74b94c9bbfac988f44cff3c7fbdba8f4e72bceb01e9e26b6022976e070ad353c8d9fce3057310ec27413a0d07ecdd511bd7994f1a9172e89f532ddbc5f91c34d32fe71aa32c1272d0443751eea95352ead050fe6b64149174eb169a2bfbb1a9d32c33aaa45ee83d7fe87fb13ca15ca5709ec72dc1004d6fa3cd70df7c426c85afec92069f19717b0f32b8f5a46f3cee15bb2aa0b29b272f7ae5999003fc49790bf61aaa1be89855ec14e92befaa9e2e7f0b700ddde3e002ed620c92c23f632686d53209532af5829fe89d5feea4b6b07f28967d3e1083c28946a7f8098079e41a078a9470895de4a6e0a7c75d5bafa54c5ffd019c51b76e32b7b021df0f0369f0c64495399c7483314577d5dba9976cfe346e09551549c2d063d5885b79e6d1a7c2e063483bc981f8a9481128f07610c1a1b10ae9bf3324224156bea8e25b53bef6ca24cc9bf35a4cc928969186ebfbca5ea7ef9ffa5df34bd8fb7f4153d0180bf9e902372a9f56e1072fabe097ede2694f58b82fb6b8dbfc6cf44de2106510177fb2cf39d147b7f7e3f77228dd1352bac2af0b3064d6dc9e27957afdd51a4bd68b86790bf85c7c5820fed099ce145cf71f26b6ef28ee302f1bcc83c01e9978e0b657f5d412c86f526599ddbd20e93bfa20353a72592819238a3df201ab2672ee69b1631928e7eec74dc6c43b50ccf8332b221b8da3ffb3e0a73dc52ae9bad73d2bd7947784885e031b885eca47dc3689f06f78ae53b44b31461426c275a483bdb9ee7c4525fb4f0019cb6f8fbf9c3bd13580f86d276682a7de3504c809c8fc6167c2f7a6b023c7a5a928010b1c54e5b2139dc42e1041490c88a56270d606cef83dababeb551c8a541a07b26ef375f68e3549397418ff4c4418a69e1eb6e2708dde4bafdc3bf327deee5cf714cabf840052c004e98b6fb56c6b2779ec1792d00f35295a6840efa6498eb5d7cb143eeb3039d45dbbabb2713c868beb05351c24061354099a5b5a4cacc0733668e2f2650be29e987923fcbb1dae0b53b7a05868363bb246a9b24c5f76af834759a7687e69f3d18b23c72bde46590c27758f4452e3d84b112b9750c6319540fe4c6f838a6a271451ce97cde0cdc1f01f17cdc46236516b4b89946c496db91c7690cab4074b6bfadf792ace9cd051efd99b7b44fb1042d229d08d992c97e2b64e4d8f6d696c2f65430f7273bf98f70036c40466a3cb0de81545001cee2e2ace045c866b5b93432fa3003653e0e264ec6887877f3dd4481648f64f592fdb3ea68e953e569eb4187ce84e465bac7324e87b4e3c229627fe60d661e302d7afdc73e4cf29c60232e29ef38733d13eab742588fd583c15701526ced73780ccd63a777a9bc8334183736878e3b82ca4e23c37354c8acf148109af6aed2ed319eb110dd04f3e669cd8262a986e85103c7c8511720fecc3583db42a84de10354f94d5f53cd80b33fdab03ec7889de3d4a12ec4fb08247d0449a84bd74b975c6b4b7351cd405cbec905eaaac1177760e0576549098816d0c08691523d01c86329d11f753160bf9d11d58b2753ff192c2a12833ac2bb02a5de5001d37864882ae9012ca6552cfff05300ab7ed1df6eb75c7b3a5c6615bb33903b67f4d94099937e5f562f0a3906f71c93d6e175be9aad20aa453868e194abdc26bf93d74c892facfa59bd088b4a6812168e1c5c25e97d232318e37d9488f5c5dd27304260fc01c67596053d8849e393ad4efe70f8358e8d9c4469640a7144907ff512ebd50e321a38e73007d2b163593c1471025b3d4bdc6e33f0aa67b075f060b0721cb0605c9d3b665036c6d2a6f18f1be1e9d775de6ce79289c80c69d1b4ad5824e06b7db9dff1e4f41c3dc1d2ffe4ae8cf58ba00f58175b10fff764c5f4cf072fbe0d677540fb9b26f85c6c25075a9239e95332112d6a6ab8d2495f1da06edec624f668e457d2b2711b14cc162468f63741471d193198625f94193cbef9d83c6e425355aa22e4e3180ad468daf9587f8831a9a50cac04da3563b27c6fe95b0618298073448ca8c2e0cd61a2291b5e9d40a632ef1e2377765cf5eb8891a7c0caf048856e6145c1af55d416c4193237b89e63a4215e6862ee8a3ba32f4438e2319a490b2d7f9e8dc5f17e756e549262dbec5a9a7adf1ae57dd63f13d6b541a9084900b13f7fcdce1472ad1c702296e13cf594734d9cdd08012fc822cafe112c28b24f62d0db4514fabf9d70e9555c8b498c632ffe1dd2f0e84fadc08cf0b461e2b7055d5c3ead90aa01c4ab2e34b71f91e292757e8b165d6a41d3524f9a305ddf77ae04ff8efeeb59e8a69d098999b1657dcbea2f7f2e15e29495651ac9bf314e4c66a1e8b36560c4384b9ae0930763ac579a096f8d7c461f5a7369446adf0ca5c5466fc871c2e02e60c511445bb4c1527c20f92cc885efa9c71f29ae0f858c3a50537e13af3698b21fc991c3a866d5fc313ff98db43f71833802b318872b3abf34a188d50d2b02af7219083008427230971e055156695d2b616d3db47af8eac32c0015e8c48d6380f14b5de806116f2b87e2bb4adeba15feebf3501e23d8eebd10044f933221623686117502c00eba8f13fff8d1d0bae70deb28c026516549ddd9beb87fe9b6b69b3e383dbe0a71bc2231abb59b1f75a846f6d7e6c34a2af1c427cb3d71f8e055ee91686551b21115b59fc62a48577817e7f07f97780ed8b2098ec5aecb641b6c3d2ffb8af20c96dc4d16b4c59635ecd2a4e7493d1fa90357427e5984c562c3cdee6e4a330dc59c47fa423cc5c299b4fc730a8d7992bf6937e7f9fd053378427a52d4931b49fca7aa63a241e8e2283a7f7c438bff1f9dbc78f38c8e7300528e34ab3e4b54962c1a873de4a5763b9f255332662810ef5d30981a13e9b461ede07d3ddc3dd9896ef7d27f79aa15c11ec73f17063ac3ba35e7ff1d6ed5fe1d0fe29588432fc57efc180c49a1b0b9e40d899efa356d4c9ca436e38b541198cd655ec9f48fd5ea640cfbcee8624bc26bfd3f4b08c6e6ea7d268481ad4e386d9ddf260c900e32295556b1d3b2e52be7ae93a0a3cc7c31c159d33dac51f52b45d0c92693d54e95b386e5664bb37ebefd8a5733bbe2c740e94110e5d0151cbfb3c2e2dd26ee28e7b4dfa43c5031e3f1223372be9a1370ae9e8c59cf3c6de854cea32607c3a8f635e1f763ed1885cd27097d14fba52eb0f355cd470e9949503fe01b35ff6c07afe98cd139ecd46de92b22323b0914640812c29f538c26a6edc23344c140b630f86d1f1c440bf98755a1bb0577aa6ad621ad3c991a33ff745461718368579ec5b96bd121bdf014c7b217467a57fd8b9ebd4927de01d5d57d8b705245e9c9173b0cfdb4a9761b28c69ec9f296e63ee9b994343642caf6cb2aa9001a9748b867ed43177f23d322f6a4a32effca6d6841e1cdd854220f4624380dda52aed95052990af1a27160f25cf44d163961a32b4c52ab11f83e4d041651db711e08561c0d934fc9225afa7943612a78b2fd8b6f6645dfd492b8f96e88f3a9b5a7dc3468c23191e480c67ee9bed0d9244751d6f779a0658a70485312e7b15a14b164b775f11cb3a1c30b12ffb52064c2e795faa3983e1bc455ee30af4c4eadd1492008122a53c66d2e147a0b598fd41e7e443777309c4f2120a72e3438361af3ce59a01fc70985b387c0137f54afc37471e3a9b481b4e238934c0e1ed905545a8673584d9ebd031642a4c3003f78e1a655c346784b7ee35e94fb657591c2f5828f73be12a9890ad11b563dbeca7fad1e660519200f9c544dba66e8b38b976ef4487672de406c5ac0acbd02c4c54e03a9ffef25ce568bf4029"
        )
        val state3 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, normalWithHtlcs, TestConstants.Bob.nodeParams)
        assertIs<Normal>(state3)
        assertEquals(state3.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state3.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
    }
}