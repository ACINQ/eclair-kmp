package fr.acinq.lightning.serialization

import fr.acinq.bitcoin.Transaction
import fr.acinq.bitcoin.byteVector
import fr.acinq.lightning.CltvExpiryDelta
import fr.acinq.lightning.Feature
import fr.acinq.lightning.Lightning
import fr.acinq.lightning.blockchain.BITCOIN_FUNDING_DEPTHOK
import fr.acinq.lightning.blockchain.WatchEventConfirmed
import fr.acinq.lightning.channel.*
import fr.acinq.lightning.channel.TestsHelper.processEx
import fr.acinq.lightning.channel.states.WaitForFundingConfirmedTestsCommon
import fr.acinq.lightning.tests.TestConstants
import fr.acinq.lightning.utils.UUID
import fr.acinq.lightning.utils.msat
import fr.acinq.lightning.wire.ChannelReady
import fr.acinq.lightning.wire.UpdateAddHtlc
import fr.acinq.secp256k1.Hex
import kotlin.test.*

class CompatibilityTestsCommon {
    @Ignore
    @Test
    fun `generate data`() {
        // generate test data
        val (alice, bob, fundingTx) = run {
            val (alice0, bob0, txSigsBob) = WaitForFundingConfirmedTestsCommon.init(ChannelType.SupportedChannelType.AnchorOutputs)
            val (alice1, actions1) = alice0.processEx(ChannelEvent.MessageReceived(txSigsBob), minVersion = 3)
            assertIs<WaitForFundingConfirmed>(alice1)
            val fundingTx = actions1.find<ChannelAction.Blockchain.PublishTx>().tx
            Triple(alice1, bob0, fundingTx)
        }
        println("funding_tx: ${Transaction.write(fundingTx).byteVector().toHex()}")
        val bin = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob)
        println("wait_for_funding_confirmed: ${bin.data}")

        val (bob1, actionsBob) = bob.processEx(ChannelEvent.WatchReceived(WatchEventConfirmed(bob.channelId, BITCOIN_FUNDING_DEPTHOK, 42, 0, fundingTx)), minVersion = 3)
        val channelReady = actionsBob.findOutgoingMessage<ChannelReady>()
        assertTrue(bob1 is WaitForChannelReady)

        val bin1 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob1)
        println("wait_for_channel_ready: ${bin1.data}")

        val (alice1, actionsAlice) = alice.processEx(ChannelEvent.MessageReceived(channelReady), minVersion = 3)
        assertTrue(alice1 is WaitForFundingConfirmed && alice1.deferred == channelReady)

        assertTrue(actionsAlice.isEmpty()) // alice waits until she sees on-chain confirmations herself
        val (alice2, actionsAlice2) = alice1.processEx(ChannelEvent.WatchReceived(WatchEventConfirmed(alice.channelId, BITCOIN_FUNDING_DEPTHOK, 0, 42, fundingTx)), minVersion = 3)
        val channelReadyAlice = actionsAlice2.findOutgoingMessage<ChannelReady>()
        val (bob2, _) = bob1.processEx(ChannelEvent.MessageReceived(channelReadyAlice), minVersion = 3)
        assertTrue(bob2 is Normal)

        val bin2 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob2)
        println("normal: ${bin2.data}")

        val add1 = CMD_ADD_HTLC(
            10_000.msat,
            Lightning.randomBytes32(),
            CltvExpiryDelta(144).toCltvExpiry(TestConstants.defaultBlockHeight.toLong()),
            TestConstants.emptyOnionPacket,
            UUID.randomUUID()
        )
        val add2 = CMD_ADD_HTLC(
            10_000.msat,
            Lightning.randomBytes32(),
            CltvExpiryDelta(144).toCltvExpiry(TestConstants.defaultBlockHeight.toLong()),
            TestConstants.emptyOnionPacket,
            UUID.randomUUID()
        )
        val (alice3, actionsAlice3) = alice2.processEx(ChannelEvent.ExecuteCommand(add1), minVersion = 3)
        val (_, actionsAlice4) = alice3.processEx(ChannelEvent.ExecuteCommand(add2), minVersion = 3)
        val htlc1 = actionsAlice3.findOutgoingMessage<UpdateAddHtlc>()
        val htlc2 = actionsAlice4.findOutgoingMessage<UpdateAddHtlc>()

        val (bob3, _) = bob2.processEx(ChannelEvent.MessageReceived(htlc1), minVersion = 3)
        val (bob4, _) = bob3.processEx(ChannelEvent.MessageReceived(htlc2), minVersion = 3)
        val (bob5, _) = bob4.processEx(ChannelEvent.ExecuteCommand(add1), minVersion = 3)
        val (bob6, _) = bob5.processEx(ChannelEvent.ExecuteCommand(add2), minVersion = 3)
        assertTrue(bob6 is Normal)

        val bin3 = Serialization.encrypt(TestConstants.Bob.nodeParams.nodePrivateKey, bob6)
        println("normal_with_htlcs: ${bin3.data}")
    }

    @Test
    fun `read compatibility test data`() {
        // data was generated with lightning-kmp v1.5.0
        // README: it this test fails it means that we cannot decrypt and/or deserialize data created with on older version of the app !!
        val fundingTx = Transaction.read(
            "02000000000102d515b2c66dbd5c3dcc67a3716920e9c6d9bcbf1c44b1f4d20f7e48d3c2d816c9000000000000000000d5647265ba281c8bfaea2711e9a75bae025fc4f27dd384e6222a2df151a178040000000000000000000140420f00000000002200201a602469a619efc88076377f24ed6391ea74e05ee6fc7a48209fa7daa725d7fb024730440220249e4ad23fdd1ff17b2a94eca459b902f7aa83be293c4d7e4571acfb1dd1e03c02204442ded42cc8348d583e3903fda063fa1fb7db4729a696d750154145d16eb81f0121028af520db8cdfae140e43e69a94c67eb944e4e4a9bcf90808411a98d85fbcf7b90247304402206314c08e425339ead9bf5c1ac364062a6ad17adee95ee52cb19df6b66d603ad702205c7628ed5a88d6993af25ab09076e0ec81b76c6f88301646c5c0c442904ffc39012102cc1aa2eb8945deac7f6b7f87388adbdb70b02c7b72290be8f34da8d72394b9a9801a0600"
        )
        val waitForFundingConfirmed = Hex.decode(
            "b6379f1b0bc7d1ceaf73806e8ff8234ad99249bf707562dda38f4359a0a64c4896ecf97fa13ee54fbf9bd6c0a9f950273570b8de71b7568fc4d749d1ee26e80d3d3875dba55a4aad425cadc61646956272773c392694c091ab499a13e138cb3937aa78abba0a639196f9f2ec43e79391e40f2a5b2a8677cfe026eae85f7e37ceb7c2ccb73d8f6d37c1480a9c4bbe66d568d1d1e56b103b5256cfccf5ab720b3efc6271f1e04a646daab288e236d9cd5182fd9bea1b1d348ea148eb2175b6e2e6f29d47ab0e2b65df029e1c799555f13c2b6cd5ab067eee28d1ac974919439f038d1b3cfe6a4967554b1530124511bb320a9fec67e8f8f58d057e46025db66c3af2c518e6c60b5660fa3c6514c42f6e46b877d0123140296581b4a57ac1ff5172f8ecfed96ae901f7262c6c342e1f3d63e938faee40333fbde8dca6fdac7b9092980996b76e24fe43df9321352e9fc704e17caea1a0cde43098761fb1aea9df42549d09822211be685f22e7fad08e3d42cad86c3efc6c709dab5e774e383d21a481c4f69e5bd6a2891006bb024e1c81ba8060fb309696bb8538d8d55e4cd3fc3c9163b01403f8f3572cf547cbbafe746449fa8b00a386b8c37a6608cdae34fd080751393b763927ecd4feefe801c57b54e6f47c35005e21cb6c8d09d7d3ce0accd6a594801b1756d197292d6310bba728e46c90ab0adb131fef31c70b7bc4e3dc646c20a52af55ac3dbebe0409a2907a7632647b100c7c75cab115323ec7a874c3c405721fa550f64e3d59d78d843dfc9b2d386109e8916d3d9ffb4e4b90fbf48894a31e49713e82f355cd4049a37fd837d277452134cbba105d903c9b8156d2e3d5b38bea0ca1a997237122909bb7abbcb5c5467f26ac1feef5b653ce5afa80e99abd5acab2e179369eeaff65072f6c60ffed6aae45735dbeea822770743bedabe63a8fa3273daad5985ad4787383a75ab168ea97bbcd0da4eac40307bfdf2cc069bed77cac0d525565e650672e9ace921b85b8856729c6b054dd0a1b8a8ddd601e9afaf5fa528cb61589aeeea87b07c30496bac96139ca165125042596db6fc3f525e235536d68029eef150766d719fa47c000ce492511bcb928d69af570549398456ec65b02a91e1f7850de62d938e78c4ad500049fdda8a473d4a8009c52553cb4c582ab8a05e494c7ae34eae80f2c080073214e6f05d8a6520d63babce4421ed35bf462c045fdd16a4a1009ff3b62aa14637d0a07a0c879461df52ee3ff82196d745e7869ba1facd8ef0531eeff7efd9e1f3a0c8b3ab4a61c5122ac39cf266e1e3fdd6dff5a843bef71855261e4667fab58cbb75f8ff1d6194064f1ce72e74c8367acf6ea3a2db52a8a2697a2b298e044eb32389d9b3a926cda14af174c0548083eefd39097013ac3de8accc93349b771febfb05faddc9b163551dbcbec4aa67abcbe95f49e96a9741d03e1b44caf17f99adf81addc47b54a44239b8a6f7a5549f2a140a4810066868811a0b44db18ead73fc318fa4093c22e337c7ab16d000b17db574b8ba9f32a42bee34b9386c179c2aa34f704eef7fa366df67434e9facccbc63969aa9bd94e2692c12b7a0e53be3c496b7d70151faeff96946885fe4f96c127de73f8c8b774fd1fc42bc7bba9401eb04ca41e6b7a1e0693b7492a3abb550bac2ad8791d59dd23d71709d6bdbc44ec7d3a9c4c596bb2384653f7a9d0167b529429cb7e85cb4c29b6817d826a03e8febae5bbd3818bb0a28086a084051475763fd713a724339ccc106d453f8dd0e1fbdf9b7ea2c85c8e0d9a1163d73fd15fc9ac1565cc0c3913578ee4c84608137672f3bf6a6524e1ab949b5af888e4f17fc546e9fe376f2f46bb81d72af9bc4cf9b4bcf11cd57e50feae3bb019aae832f744489c76e8db57d94e0f6bf912751dba1aa83099c80de919afd14a0e5edc5264a927da998e47e09c7922da3199c4cf4ec22698d31596213e2d7fb0965c604e91bbd47ccd754c5e0105b76bffa69049623dc0db8957a22baf092ae9f3a43042ff1eaf886cff837e8e30eddcfe44df6768128d1f91651fb43f52f8400540dae4ee8e697ef0cd5cad0bbebfb106018d646add4e7a8bfe743e25624b22948e45623c2ca8f5d84cee946a2f26f4c3d20372279f8ff3a4d9d4745e785172a97b87694c3e6c0f893af2ac41f6133aa2528378642e39d78d103d24c0484987d5e9190265fb1b85ae0757b549d06aad7b994baff0809d07765394be7c35c21f252f8227e2b45437f789d96ac78057a800917e2e5cedd9a07cef21277b1c3a0e1a56094a1a295a8a6c62cb04be2228df0aa748a4b022c932e6ba437e12b339dae6f3f86e0e1c4c724f9af3c3e263dd9ad173af1a4b5e1140f9cc6c54ea1935e40c1efc31d1ea520212f35bb4685907110fcb2aa72af410fb0dad4ab0a1509f88e4b6ef5b2f360267641b6df0a70b0947580401360b0337cc59ceb01156e9964f3e09ff8e5850dd57bfe806ccab5016945b32b1063226cfba1ce8fb4fbfe970433da2adcf0b8a10d0db199f25a6439d0c1f87d827d2440bc7249626bcc1dc75466c2434f966328b34387820a08fd9710ce83ef0d6aad6c79891cdd125b66e7650b5886d001ad1f84bc6d9d1fe624fab6b33da647cba8c90681072afe08afb096a8e8c88d4873ca293585dbffcd0985d2872e0a9e0d104d3dfbf4ece358128af5b63c7187e85e24dc830bf425374c560d6af4e62e2b3560230a0d236424c43e8f6c4e769833dc8a61083d364856c5d6c88755b9785fc137a91dbb3ed2ed87f5ab0954561a38d92293788bab51fbe6f58539244dcdc02e0ac7f5bf1a207446deca72d1247e6b5e150351a1388f6d1ae96e4e57ea2aa397fa5416160061e38fe28deff728f64f4ed8fc90ad3c36bb9d238a5cb359e539eb5991f4bccb69b82a037432675e7eb8967e702b573dfce13da393df8b04c9522f9db40c1fde6297c74000849052e652bf90ae52ba8b0dad706917f572983b0f927332f8c379bcc893874c609170ff324ca9e6926aee3c2679ebce5765bb5fd3d460a5a3d039f4e3b3e209cb2ce9a19468a3bdc7ec52867a1d4aed164ec8cf51ee98741bbfad0398872578af904a97f388b9743d09f46920497413c528d9e5d9421f235a2b2be4d0fb81bf07301c6806876f5c41623040a11b382ac709fa64ec2fd884fe10dcfaba670148a45a9fe1e468cdc8a0de5b90356ac68ee6bcf525207d947ef09e773270b0b710b04466080897acad148177ba5fd12026e1b0d17074742e07d2d3970b8dcaa1ee2481db8f7ea63482695de4885db281819c2f5bb6d8e6128b9bdd9d56d606463cc18ec16d56a6b0674279b817191378be40614c6fd55aff2bd196263ea7810f615a541609e7d9e99657fb99316cc8b4b36d09f8644815e54cfeaf577db1ef57837349147454928f4c1c0c38a51d22e32c6a9e954cf28ef3217bb7595e87aeeda6f2bff7d32887febca8843adb02ecca2b755b06f6aedc62d3e247de0326a8ce67b61bc60a8e118358b4968fc6a3657b47d8d6d1639191eea612881365e433c4950a6714898d283ef1d8d1b94be55c73aa65ddf257662e4480bddbcfac52077a6a591c03f8e375eb966089af63c6c72fbac26b073451ead97fc7612952da18ba9ca179264a5908c2af5c8dad3af9ea0344a5360b86e903810e84e9e25c16834cecdedd2232f1f8f74384bb27e770e318df04569b3fa83d3691fcdcf773de70e5f47b7d3f189013e0dff68d977b4759d337fa11ffd02ede4adb707f0a6ac6b4790fd78a2a148ef4e555e56e1dbadec17815260c73f739d2e09788c6f9d5df2aeae4aed956e0957d8822fb6e05cb6d6e3eeaa4d353c04877059888481b4f6a61325d73cf3867c4c02ec7185183dd6c49cdc4c6144cb6c9e8a0914db5aa841e12f58c85f29952ceb96bd183206e786834f76d3f8cbbf4e6904437cfa1c0c5b040f1ab619a3de8632c93c94c1bd994b6c86ecd0e1e945ac6169cfeddc305cb3c2963f0fe887a6de82acd5ed4726b6d034cf56ba22a907bacea236880cd4752909a2385ab2219fa363255571b860203661d0d51457495052d4394bc78dd5b7adb66c2f787b84efafa30694f8c75a47a7a736b5054a241fe5a8681631b67bd61308dc7f11c4ead384420ebd1fec9bda106bb474b39a3ff853cb2650a28cf51c4f52226ad78919083770896f137106a95d9fd8639ece8e6a135aabdafa2c13961a14f35e5dbfc9b786c1f7d02f247f7b56da4eaa2f2adefb8cdbebc46be09a95786481e0d6320d100ccf71299521229ea15a2f25e8a232998312c72175da54b89079556ac07c964401d5d2cf558c5bc1f5b43e9212fd58cecd22eff2e0b4c3f117842a784e3372b782140994c9b04d9f2b72af28b6ec79ff00a63830ca21389353324c78374ea0242b2f5e6624aca2d6dc39d880c81fbbbba56707a9a8b43d912e9948f644667c2df400419e546cfa6ea864ba73204bd2e55a53c597d53d5cb2643b8696209bfea4ef5fa4909c1416bbff057fb4863e5777d51bf0047a5ff3607bad8aaff6069d0971c324a1b6e342c9ecb1cc0fe72ee56040007cae28fa10c36f379064aff6d91ad94db98f1925866aad6c6c7ea818500558a9e0d56b6822936d24463174eec9e46fa6ae10713013785a97fd082d8f5a9110d7732e4b9ddacd1444c755a4af87a27462a1bef7dcf675fef35414bf563310c8e101978a272ca28263eb6b6f2df5c7f22b4cc1318edf7c3c8220d4516619b1e8d4680ef7db3a37f556e0d378c3d45dc74747511c6c4974e82001ac1bcc301d2910c8848dd059a9889eca71ff9ba8d403f4c0036b6cf7d52d6c5a0c8e3118342ac21a109297b2c80735d319cf966e0f7067c8a6006019df4d93a6668d4e279d638fdba7fd2187dde3ac0c5bb71f6d87a9f3525465c671556645bc1ac1de551de9bc35f63c3a8e50b0bce5e95bb5f6b36aba68efe033a1e8651b70e9beb09e5daab5293546f6092795191b6ce8db485aa70e25b9dbc6efcf2a15b1b153a4ac2fac9a913fd61176fdf6118abc2df70a03efeceaf3ed4fdeb36dea9754853138d71fdf66ebb44d9ed5f31ae353c4e1d22b08bb9e92ffdcd867fc9301b0073da803b0a736540fd75cb43b646f37926bf0ae71e24535d8dd5a34917ee52e6e9783b8032fe029582629b55a9691e41e1c04fbef3754c222f070fb3df5f8964e74591c3b0b5791e02285df3707d51699020938032fb88c779416fb5fbada4bd1e65693440c4e20b707bbe827ce37df547a93fcf56848c1bfd7bb1833961fc9778d13a0055fa12f68bdc69787c6a97356ac7258ae59e926e064855dc4d358e4e7830f32d4d028e32f6f788bec2b536a322ff3459f37c58061bdd6b69424bd1e646658091d65e370d59ff28a7aec30faca55c708af076b6efdaafa968312722767a0642f008b378c428acecc37304d460a83d045b812face57f27af38f617d0a7e7a2a65376d52b86ae75da5c3ea4c820587c311e4d9fe325fe3d5da57eede8dd7bebd72cc6c6e6bbf07ed3e0a623867f1128c430db4c880218f09821fed2c4d2a2050e58b73f68d3d02223816cb9a6d7ee0ec67fb29ae9deff0883f6a0773ef4ff4fc1e4828664b75490f552729a5b8273fd6e92b0f4f137a11f14d05753076d87c14820b9701351851ab9e305562919ac3f827f81a0859a3c4fa82a7e97b2704b4781695bbe898276e312ad07af710fc4895ad1e3fd45ab8ff7f9330fae5f78543668ec1c3d8a3a0e27c0286b6d00c484bf1e7ce0c97460e1b120b394624e4005e6f07e84ecd4052615c17af35db4ef2588844f93591f9cce408b79b657e446e8ffe52629259ffcdcddfe365cc9916795deedbe6cb092709bf98aa68e2a6e0bb28c940d850c7fe6192c3aa6b562b9a03e89d8c4ba4c41b67b8329e73bae9ea9b17d7dbb9974dbdb80c23d9246c5f5a23035b5c18a17bad7103a5fccdc2257b4f04f318ea6297ba5c581489c7b50e12cae92a9e776e951041d6e5f313e587b9d4f930512447feb4eb0b4be380bbdfeaa7aac2b5f8e05a1735b770dcd957e9235b3727222d8866b03a2bf1f5af0eaa45197e4dc76a8e0cbe14d5947afb69dc8f04990af5f8df665e0312af01906762fcdc173fa39b7892bd6ef8bfce84e2da3cfc5709a8bec483b277e18e19fdd61e0254516157ca994fb93c9743e3e7a634bbb357f82da8681fd130dccc10bdc31afdb84a1a73d160663e870c8a6dac6d4f4646f3fe8a6817bafaec1ee13fecf965e6fd337f1e7cfb29936a3ed0613ae3dda1f86711a49832d86e9d2efe7ade6a61ce232e6fc9a8be6b686527521a8b59081d8930e312d22506de0f53384c57ef67b186da53e947d547956a5d3ec434affb3aa73ce34a9bf7587702913d1df348436c69019482a27b1c8476a48b16aacaa5f456cd4760864260c41848ab544a39cc18628ac70cf0e7c376bde914ca8eb2d55a2c92ddb13d3689e760966db4632a911a5164e55fd1b0a12db9e9b8499171a2105fdce486a950eb2ab238b7a22e300d363a38636dbf5dfddef6d7e058d3a4212be83e1948946c47ce59ed7f630347f15c18eaa77f70baac88b9ff13abc699aa8f6d643249dc4b9321ef41ec651ca9be010d4ee60b3d002814b53cffb8ce023bbb04522f187bfd6277f3453fe7248d3c50eeb5b15dbd1f428c61b74d13c3790c363a6a4657d62773807e747eac8876d0b619cc68716df39c85be87b585dbb2aea1b8c9eeb5601ef06d536517cf3e"
        )
        val state = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, waitForFundingConfirmed, TestConstants.Bob.nodeParams)
        assertIs<WaitForFundingConfirmed>(state)
        assertEquals(state.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val waitForChannelReady = Hex.decode(
            "9edada98efd89b146760c0b03e28737d857fd5610baf907c9cc979abadfad6bd2dad3a1c06dc2f3578ee5f031f6a1f924e8824c9e0ca762acdef8ddbad0b131993ad3e30185a752051f1d91c6c9cd55976278749309403be8f4836f6c6b65fc4d23320de957c2d90a6bee72140e803d00e6539f38645e159e10bc0f94ae18f33b3ebe5214d3c8555239eeb5116aeae5e98a27fd7714d50e0598e11aa6bf991b1e3c0a7f8c617d2c5883ed37f93ee37ce5afe2b1f455941620c709ed85088d289613a065a46a213863bb60baa96cf95b0f2af670d71d7de64b8643b3153de56eca6c4f27e27c02911ff8f0c2bd53413068122e347da74525869e19c3b0f8da1485468c22655ce3e908d63e97e79e24a9ec8b1fba7a2b09dc0356aea1eb803a21f0c90dcf178a335163408555c03d4eb879310ff14904ec9355a11290ceea11d0381a727eb6dde8312122a0e670adfd63bff4c85dcdc4399790fcb02737a99ec9a6e5340a5c3db355edf2a1c4500d0bc295623dc76f05d1bc5420df6988037b2fb73759a96bf5c1f096bf902d59cea553dcc98046296d4cb6da38061b758bbfca4dc4d89454850d2f42b8bc13838cd794a6ec6e4ac442aa89e20b1082052309bdfcd22ac7a6869824dff1d61f318def0b0ce64f0ed0ca01a0c24a4ed7cfcc9d0f6b6d7ce253d3c065453ad2729a7c1ee09a2a994e382aee140ababd822045f1fcb50eda99cea88dcbca223b60ddbd35b4ac62a296beb79c5cb6cece0771ee2da64544f984ef87745fba76999ed0ad9d3fec4e449ac345f4374fe1c524c3ac5d1d4e864e0df83169ee472d31afa193b641c610938223675c5f63dd0c303b94266e24eb1f3deb7549e6a43fabe1f646d401c16401a90334c52e8e35bb83a1170c4d99435a73dd62e253b2532b02f5826334e52069f05dd2bf292adc4bef8ba46bc9bd15adfc1a8c11f7ee7b6914f09a21cb27b180025846880f071c4b4a5ea06a7e44308bf6234ee4696b4fce585c1f140fc1cc03844a7a43a876f1ff435d93d119642716144575ba4884cffb65fea760372b3390aa2440d19e68698aa8705feede8bb5ca08b556820ed2d95c7cf40e6ba4458d3d0f075cfb5cfec1ba8ea2a413bb2c7e79039ff365a5284c4c6670bec9700e15edf2b142299a130eb63b7374bf028cf1c944287b5d7c3d13c5f780ca3777e69b3c2cf0d05496cffdf43170c2a7430a378b059e8065dce2442815b73390e9b0ca1436b36ae119a0759660cc4b958740ba213fd1a2378ac9816fc90f9901e4c3bc7810eddfbd8bacf9cba0e7353aeed34de8de6ea4e07023e1f5050391945fd38371517f30fd043d8c11b293e9a1bd936f44b6076e0bd66dbfa373280896c00f463a4848ff86a7126a55335e90085b4c7084e3552aec892135d10f03603bf825264a7963f9a8d92d2a1c0bc6b641c4081dc5352b980e744abd9cf79626ae178fa358230ae9b6ac6d6e97d36e608a73958d2a3675d4b2257306175b528025f4123a501d462494c750a43f0a8a06e979c581f63b8f128bf86ace69e6e3bdc2c5a88b5789624e5e93d58757d65d1743fc118781d148fd3bfb3fb37cfd47df0e64f9ac8a1c4e1023d5abefeec18ee8affbdfc23b63cd6f869c69b0e3d75ca33ebfab4b5595cf06295daa54950c9991f95220a295ff199a4b617b9459c3f54ffa0a64ed0fc75519722b09b920444eb1c92a1e25a21cfe6a9cecb1e1d8f6baa89dfbb97002453348ecf895275eab5c4d3c394c19d5e9a397d864f1a17aefd39efdff5ec3be2e8ec24769b0b64f6df9d437904b3bf8cbc8e031c936df05ae6de5d476a811df13fc2324f66c942d9d876910e2cd4d38f5ab9ffa828130958943199300fb4476f293639a57cc7cd019f2ef79c8ae539fc69220c2a02181a1c871492839c621096079a0158e8ed36b3f3a848afa3dcba6a3eccc13b98e5aee10924104e7b1aac4affbefab3367c17ab3744fba9a46337d30e5613b6b2d3527d268bb7cb4f627db57a4311a40a16efddf3a1d6dbb73416c5968cf46c9cee6322713399499eda8a333fe24cbfffa545d0bc5431e9f63906ed9c25cbc700f379d98f53cec29f09fd05b5438cdc4bd966cf3c9b6114b27d285595677daf7124af16506578204725f677b3c56b9346bb6b8c3b59caf25b627f9632fdc3dc4e42bc79bf584a1bb113b204ca343efe7f0a2cc6751a3d20f6c1638265072aa3e4afe014ef43e0e23ededb10a7c8200f0a58f160ef6c38f9fdd9d2b243e071a363bd186a3bd054faf6d8199ef5ff91363aad4bb6c5f86f959e105b66112870b066555b5cd7481906ac83f2686e5e0eaaba3efdf9dfdc7339e1741d8a3312f3bc20d349f02813a5df9e8499ae761870837850823757e9b64e58a61d1960794674d62391427d0a9c24d541488cbb337a9a048581b742d289ff52b6d7a9872639f5534390fc54910eca7c4fd4fc4670f805263821e9d56bbdeecd50e53670c0d7ed6282f4ed7ea2bda31de57db4644fb6ca60ae95e3818abebffd22d4015bb3257e246a8ae1f4da005500431c5d63660de5995a31c6375f0f0ef644f348d86c83095028896ee2a0e08207003dff546aa4899afbd8f6f056c0337befa44ece3d8583be9d5f17efe96748599800269064d75111614c14b51fb0c7e0f8bd68907dc2b8646f6bfcd8fecf3973754500d266d5fe1965b13a3dc9e28f73335356225b306dda41937b391e359a39d07dd68fc770b97131e62324f45d38855797f3d0a6358cfa70ed2c33f5ca23642a53212eb714f4be6e9e54bfcc0b695cc93e36aee13870cce040b37fd6a4495d9e6d85de7a56610203628bc1f9e5c9e2d4e26f958527e01372cd358c192bd251ac34c758e837763e713481d314313cc869b88e46ec783234bb3564ebc1a91cc7989a2606f51824950e830923b0e467cdbca859fd0c36a600c391e608408dc8d8395383345167cbc63cd1367d09a99eb5ae54024f0f2ba91762f8efad53f2f270beeffc946fd55d21878610f4676afaf755156b7c70cbff8d4c01ce9c16a98089eb539c24b7c774faa9dc54e62f0f082e334bca6e01e5cff30b5438aecda3a0251b5443f2d6f8ac3768eb42ac64225314cadf7e65892131673366c3846795f0bcfa470e994b5444da71a0b9649846e546e22a7ea2720fbf423dde6f72812e50591b622c978a89d3fdcfc419edd3f4cd734e6d2624308feec2ab791b4a9778da36e160d4760699680154feaf240a6603d63079a8429b9100ab39d0a9857d4063f636434f055bbcc2eaec9d5fb2b3e38009bc17d6bb6c85f9ef50efd10d47f97ebbcc49e1a8d369e9db72be436bbcfc8bf88c4de90bca7b544ad0207812622e33aac754cf14174cbbb8aa9f0d0365d4d00d3dd1f3a5fedbbb37b9d7c326d52881028656b3a4bb4e8580af664843d27d458f109fbd3b0e8d4c7b770b38d7ecb89c10ecdf39c1e76dfa34cdbe164dba089083dd84ed8379f960e831ce35d0f5f8c5934f21ec66496073790ed6d456d07dcdd552baf955d092a091d073da27f78af196da3e4997953c6e20e7a32bc3fea92fb69d30e466a0a9c860102189346fec18909f71c63a153dcf8512e6c5789fabd66a19630e38f753b8e37b5a01484a63518da2c41d9444a076804124ed4a9b890f599226d43a252421c9c774c29129603922a55ea348535300c0125315abc543e6d6d3d2903bcc32ac9255054c48745b8af3a919a67e90a234f0b925b1462f1bbb004e841004481fe24b2a6e611a48adcf2cffd595afc564506b84008fa3703e04922c6aab03b518c7d32279ba3066866e65b162d77d502c6c12945d9fa101165522f10e29135d49015185ad025262b4113bd15f444c4663f974fed9a290581af00387635db4380867c14e4ed66d52cbdc82b068c1d845a5ce6e45e0bd3af7ec98a17df07d1f7535e00a1a014a825e984234b2022be019e57cbb85d3014f77c14d4ffa7911a39f4eb1f2edf9c336825c1ae547fc498c2e0f97ad1669510d6b3755ab7afc85b9b89e7486f43918dc8c759613e868e0cfd21adcbe8728c0faef20b004fdef742479f1a189e7db4728e07e89e5221a6c43e40fd3f84869e66d27328e7202fae9c27081c29ff9308bb87b10921cf67af92815bc0c0272bea99a71a481b40a32227753afacf15647956a73c07edaa8b05480567f52fe59675aab92d0fc93f0e6c154037c66aa0955af641c422ff63842816904b4c7f75a81069cfdde9f5c52de88876d3109324ea672578d7c96297f013600fb276460168ac7f451b349432d8d003498280fac3f3aa30db21d5c5f84e4e3cdbe84338f1575141f48cf6ec20a2d9042328ea335650c11db5d5d6511ff3265d73c90d1b3f618306d167d4c069326885c8603de370b73ab9096dab67c8a090a215220229c0b724340991eb326341db2f8223daba0153d8d70608377a554602677b2f089536dd70ed22e337192e698e52590ca5a2a545d94001e92dcc87c3a0a1fe06f0bc04789e994728d9383b1a41d8a3b8683340e9caa3f2ec0cce951c1738836a6cd86a55fa2c82a8f4c7ae9265c6170e0849370cee59d61e1e45de075fd464ad03dc3f1917a12f661473c0261a80bf2bdbb2560908df132163f6bc7afa02fffc46522cc257984a5924ec4998c5082a2c70ea0676b57cbe733b1c15a0af38d22afc76ebe3e52b3aac46895422eb032a3cd63a47a545e66d09a917d29ba793bc77d049cf7c2973ade44cbcd98496980e5eea1aa2bbaed8259d9c45b624fd6d5af9a12f2522f2e3c9260197982a51d1a57928597278165c1f26733e8064793516a1a8a9ccba6f84c7e74a3530bd926b038a5438185988cb63cc4d526037f80e5728849dce0f4f9a9715fd738fe6e67cf20aae24b24fcbe6c7017319b6bb612b388ca8981a3db104717b19aefe6e3b67fc7238f95dbad069a4e9f92eb6293d86f75b79a5aa7e2f016d13c60302d8b443902674d07b75585d6a0882d20cc36ce61c43ba8bd2063d89af7132642fbba344c60308406ccac5d3848d46fa99e7e3443f2c6cc324e2e18c5012ab749954e0c58e6f8b1cd4638b714d73015bb07202d5f1d48eae2dfbc65e978bbabb36e2f7b9a482f74e143c652116a12774f1aa9ab122064bb33b787446a51e02b051e4a7be61f36c3916bd0d468c3f9ebabe474b657a38dca0622d386bc82d1d83f5a39bc1ed987b7ac86b6df80cb6c70ba9fe6bb3871475509e1a4f45699d9ea4c981baed8b1fb2b7bd0a1684aa145ab72c97117fdde44b1437dedc3bebea817385afcba39b72368b939f01af2cfb792af0001f060611eb61f7270ebfea0959ded5fa05673fba7485331342438e40d96c5e422455c4a1097aede0e4ae41228e780fd76c009dab1244e28de9863f390b43cbbe580c36fc4de97c45e3a8e1d9ae1c0d96d64bc02198a01ea76f007364f404df66e219e65b51bf226e21bc0d18ba9da9e19b6e429d9fd257708777efff8bbe90dd99535078d23df6ff83894491bdb3f4dac0678dce885019fec7af50a528da92e61e137290cfe262adeab115bf3ef6d83f4bd2733a55b45f9f83d042c72fcb55f22f05a981876e29b7febecb4969feef3d75b722cbd72226e8597c70b0e74c562c168c2f86330bb81bf71c8e28ae9019a83302430fbdd60caebcd8b049c74045b46d4556e1103346462354bb0f3df2a9af8cbbbcaa493f41a1d2fff58387a650b72f6e53abdcbdb75b0dcedd8065d2fad9959611fa626070e51029c10263bb0b1e8eca8042ac223ee87cb8bdb76d9fd3454a10dd6b87a7675f6dc7444a5e722e8fb3f82df94bbf559f7937d3b5a5c277a8568b36dba147fcf49ee94d49ce97039d805823f93b48690656ea1d1ea6d51d5c12c7b163ea4eef10479a35466830de000caaa984da3523e296c6c9138955856622438e7e749665f87ef1da291f4e84efbf252aa3f9f7e5013f018f1c58de622b4e80bf0e106b58f8ddc378d04cb4c36a86072fbca31085bac8321a02ce4299e65ca11a1cec24b16d54ba89d997b0ed2e7830774faa6d7626ac20140a87f95bc9633e910d764d1eb8ae55cedcbcd47460a5e52ccb29733c1a3ad771435e47f1e42b161a4bdf84506ace872fe130e8be11bfd1a7ce7b3c5fc0b2c703c2fde41b4397577eb2035c405deb3a04a350d4d1dd3a51dcbff4fc45840b829dd5640122a00ae533c45801bdbc38b88bdd2711315a73396aedb4a0848aeb253451f277ede0a47ad23d94b51408590d438820428e876cfc4925bc99a6a25ce7493e3afed59f10df98084a78d2f7973f5073df65c610a5402fbe6dd5be2be3431c73283727979db5754e7a6e930595021bbc5594613f90302e845b926b7c135594019e1925d7e6d0cdf864f6fe71250f156791e524685665af4e89320cd237ff45ec3638f91eb23de837eccc2d52cfd5492ee5de544fa38b509dbf44491a2eb0adde3c7c11c466a6f58b7c2eddf"
        )
        val state1 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, waitForChannelReady, TestConstants.Bob.nodeParams)
        assertIs<WaitForChannelReady>(state1)
        assertEquals(state1.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state1.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val normal = Hex.decode(
            "d9be7d075353c4865805350b49b31ca3345f697f5e72276178b2a0685b979628f5cb0cd7066e4115e9eac5477de67081d50b4505b6122274bda68a0f521985effc584bb17bbeeb9f27df59544580865370095b1aaae772647fdf4fdcce53faf9cf13bcdc43310c555ff6f907ab55d7cef29c0d8fcd5bfdd06d8d3598c8bd78cd62a75a61bc6539b88dc267d1674af7cba8cf37f1106647282e1da6c167fdafaa63fbaa641b4680a0cc923f957be3b6b94e4aa9dc8fca70721bcbd44069b45341d5dc53246ca03557275fc0b8f4219ed42cdbaff666bd6b05673b48bfeb51ef25c189b0ce40a158bc09d395023cd23ce2dfc09ac6f446a8d2af74aa3843af0ed7c8dc72ad4f83405cf759bbdb8f610b4c68d17640f61b979c13ea09d4ea7ac82b43efee9fa1059dbeade198fe349d0ec10c9316eb9d42ecb2271aae9c6af9bc8ed9ff2630941f4132032e6538eb76746d6a458bb3d04c96a2bc48f01d711beb602119b428d5fb5ff410137a8629cdc136e58e0e3026d148437c0c1bfed473e5cf8df81f5b72238c521d33247d542ba86b715880cfd4edf753a7e9364d9c2dcba3b113c21b0c650df3ea36c7a1272d7fd61435968603393ddc85d475e615d44a28b98b22c80dbbc933c334787a00210d374266cfe177bcce3b7ecb0b0454080d42518535cf014b00184368ba379835bd12414b2591350746b6f0778e36d3404add5df3933d1a9155c63648cbf53c32bbdde9ce7365c57b720e5a1b06ff09d7427aacddda7280749d57a47eec5ecb4207cc2642b5da041909f02462780c510e9d7aa39b0fc26f085d0d9bc9a54f7e7df4db28e26056b7a8076c2b7c926be210711e5e5fa115dc4721b0d5bb19afd09692826613e301d32132743de845a700219ce4c7e7fa2a04fe9642d560e8e961571aa5c2e2a9fb16cb22bdf81ffb8129f51698f4990361c59c8230c64e4cf5c1ac505d7a11ebafc99e8fb9b3e05d9009ac8c6b29829e3235798f286a003d8f5ee4a54606d1e4334a79009ab947ecead0e6e6d575bc4fdf910387cdc388b1d6b8ab04e9f7d9ab03fdd425a52a1401f72025f41fe88d82fe4a900f94a06b1cf37e4d0c00b20628c0e8288b299d1c92afa93f23abdf383e3b997b804cd8f495a2b4db46cff9f0cccc6b856beb3b39c27ed70e8c53bc1a00bb21cbf19d1fa5f93e4c5bec7d795875e4c1b46cbb4ed4d2faefc27407dcfeece3844f3c210ecc848bf56ba1d56e8119ae7fe295a3266c24f324baaf72956b8cfbd31e22ade7ecb0358cb030c92bc76d715b3ba59fd0d33766f2e2b8fd807c941d507d731317f0f8a3fe6cb3a86659900aa8523b83ba1ddaeab85c2ce4c6fe53ac2455538ec93a14d50eb9a9252f5539b62ce7d3a17a494a536234d8dda9626044c0613f95fcc1ce6c303723a571ee99b76f3a1dac58a2e0bd49811915a6d4e29e4061c4f11ee32f72eae61d01e3ea61691fc8cfbe99e792410f11ce99cf3c30eb9a56a4f7df8700f40f8b54df4fe6363b14eabbf9bda34d0216cfafbe7fd8f569b6682366d950b705b363f73230ca1855ac4c95bf2e53035e37a982cfd76e0be8be337ca6daa2f1ad3f07b607cd4745ffe3e1b60c12f8d49cdaff8f511b328287bf458abea51dd8cb96a8d6c36613ec606a96dd131614d7dbf264ec446869cf727a16689e4f75e18fb226d1ee62d1b19314b677af7c3f6a1e995022561fa35c05af28cfeb44ed572cf6b956867d2ae0f73f0e3f4baf24acbff3627b86cbbec3a5feaf146563ec54dee065fb7e4a214c44d9f26205c44478b0b396bb0dbb2cb720f329085b82dbe3248028c341f545b530b3659f978a42686c553b31f549b3baceb2f0df91c3976245d6ce529864f899838744017970b1805029f888df7b9c69c210d171161e24d9e91daff957c81d0e5b0f683293d666ca7d3d1f760260f6a74fcaae437bd08dc6269436c418c782102a5c23470123eacc1ef63e530e0e452206ccf93b94ebc6fecf1539b64d6b510f9f93d834a84296ebbd1c6b6ec517f53429fa20c6d1effa0656dc6686e942d54bc6d484542273a9692d94b33739e47377b6020db792fccc09be83154862fecf3b7b5b3c40e3da5093423871d92c2b38dcdf2c5bbba3eb3f6d0f00fcf701efaa9c870dc80216b53048fc49a4aceb8a12a8e7ec711ac7becf682ed6268cf4d173bec2cdd95347c13ed44207c00213e9a7edc22a5d749f209dd8df1ee7fae50318dae8e6879a381e7db67a01a3c85a7f6de7eae301421f56f41efc54a632d560c7b06be83ab63a83661132473db9ff5ebfa0b2a9f8ee6ce37db71f56ee8c2975505c06809505f045a0896e7b2ece2dddeaec0e3fbfadeada758bc22e90eaff4222057cfe01c95fcbb9414c050bef9fa0113155626a0a76369cef55e89b8fb34c46b9e7ddfb1bef80b6c9cc7dfd4961fd4c1eee8db30648d2ef4d5511dcb9f9a639681ff9c241ea0c1cb6b050d8d5968a14b065453c244d26762f1953f767ace632d3b196e8d142711c7294cc06e0e46222e91052e141b2a11d40037e2a0dbdc2a645d1d50a38ebd28fd9e2078d07a618b78d7ba794a7cd1c0fd5f9314f0d1ce4bd587f0e024fd311eb0ce5c59d65cef1a7cd15bdd15246f87511533b156d2d8e8d448d4eeba7d1fcc8604526c8996a295c1932f85ecf067de93900a5252b37d108b2bf7fcda3ec035c6b74626261a673d9cfe798687adf3e2a4d10750c1d65a804a16142d29fd46a66ff904e76a14ec8683e8d0a5442d1f6dddfb15bea5065627b6b39ff56d2467b425d2d0b9e1239c37382bef19a608a636359b6a74fc4138ff0f0f344ff3796fe6acf92c096fe39fb79bc855cf23e82a1ea6343a6675bd153f79f12ae2682d620cac00d958ec84511cf651adfbd989a18ac992c0b0dd6d961042b066fe925db849712abe32ab80ed19e05b66141ae93254894f9a09ab8aeb2216892824692c6b1f89836ebd8a6d65c0298b3675a3bcc724bb4b94bbe29336022d8d9b10caa77f0317e6653d01b6160150537c545d907a1d0f8d70e1a21cd6b64eba7cddd4e05367c877bc723bfe023ac0dc46b92066bbe5ac1eb025b0a25574664d8d8c29b22a70783c7eade8cd26f73e3b8063cacf7acb0e806fddd1ca8050efa316ecd6d877a5f64887285780a50fca238f1c0d66c2dfbf0de53e2c8924d4a5d85250e91830b7dd48bb3305c87b3b190ffffcf235e13f183eec08c96574bb66cd6cf588306540e5b3a4bf999254b6112c4e94b70a3a391e362dfa836584872bf3c12123f236ad91068f2176d107f06663e6d2fded888cdaa78f418f73b4dfb2ee13389542c0ba4ddf3dd6232bc4b1876be8aee99c8a3855b9b25138bb5064904fcc586f57d0e1941c223f6022c12df76b3e560b38b5895c82bf3d21dbffeeee06fb646c4b2bea6836d1f5f589cd09d88eff82f16c206237c809b06cc3a7a0af47e229631e0c872dca2c48d4d31240bb4f6f31b0f937112998e1bbbc3aa915a6dc4f8f5bfb9d1e59be148d9e8babe8688726f4f3f6af45205a4ad82c6a8664bd2c40543f865bbdde571d70ba14adb190b74678aefbc4f27de979d775984927d118c3a0366748d324d6345c09527c30df58821a26f11663d84028f955c25b8a58f8be43f81364592fe5e512f9006b994f697ba0ed21ae6ee29cc0f23a9ad662c44c8672b020e13f6def8ac12e04a4e2f707b1249601b36537fa44c78ac8511bf6b19ce4d7b862b21375bf6a5f33efc8f6fcb8c5244aa6318ce734ab4c1ac1a3be17987805430a5d10267acef09d440905b656b6a30525725ecd9430e57a10c6d0ff32c7dc21dcac0cc835064d4791c4ae7bd2eda5af1a3e7706a740ccbb40990814a1e47cb8872e2b065ce6482314237d12dd60c7b9c522a8c3176a50aff9dd7ebe002ff9ad82f97e5adf87a307df56ffab49a580b04bab98d74f27babdc1a3385a322e31d591e18c8b1c535aff5625a87e16a8dbac2ddba760f0dd5ba47da04690bfa132c796dca04845e5721ca3d09d08afabe01029ebe89fac9aa49558ec7263d39a9301e81913d3bfa5258f298299196541a210ce3709fdff85f81508488e4419f439cd0ad7829a031a54d31fb55ac254e6219b39d3bdc5aa865c8c9eec4e046b3c08b5299bba69111a0a532d346d57b8c11351dfc835b3c0a98f4ee57a5534210b175d6d32bd33fadc18cceef218dc9fb57e959579f9c932208adf3b86ca2fed2dfe82ca9146f182e3f9167c9827e9bd5eb2bd513c29cfc8ddf91e411c142324f8383c02013fc72b37e1d023c9b937c941391fe2367a230e35ea3ee5e2922b568435b9d08b393cd0cb816797560317bf4abf466cf2dc659f8cc812617ec44cd225ccef45d238bbf34699331bc9fe130e1a05c96a4b5f721ecfc0c0c4fccf9dd6920c0a1acc397c23bf5b77c50406d7358021dd3a898637656c18a97764d035775261caf2b601c7fa748a0e341fbad8358046fbc253defc3c12ce01bf7450d7c2692166498de15f0620da99c464b5bc4120fc0634ae93bb364f0fff5c591e72d365543cd9f8d02f144e1b51961b19c0d147998ca034fba1684f2ea381ea44f6e486bdf650ffc95146d89073810b3f28b1e3aab520f8edc90dcf248b15f4908e121511aca52b85c041e72c021cad0efc4833d58e89c1713e162f2f5c7b8ceac9cfd7676aa29c1be691db684079b251dbb2fb344323750f5c65d806eb6c9d02cb52841925abe14ccdf5fdb1c82564471ce065a650e7b603b197807af5fdb66f4c485bb23dd729f3595227cb0e59ef034222090900f66c7dedd5665bfc52e0c137e9a2e4729fe414f156a6455e907b4a1a74b4e2920911b38ff2f7c2da76df00f7f85ca7ad270563c2a4f53eebbc192d5638b9b0e481512ec266e3a0a1d410a478ceb1e00aea23adc31e7abcdac9b7c1ad547ff19f001d3a0a544adbaf6cfb66a2f95bb27c059923ad288b26b9c62b751503ddfaa2dd7f0974eef974ca018eda07a092f105d8b91ea7c2722da071c028a4e1419352c554c1df719309b84aebe8a0aabc47cb0551c00e95e4eb37786a7eea6d416c827b2562f87d694bc7d830ec7a12770c2021ec26a5bff135d817a54ff503d2e01c19ee811d2da350742e76064e201b476c085ab242f2353bb11f0ef831921d15a19ed50eded0171ab8f7b9aa484a88a70f79412195c6adac91d54b6c5f69501686fb23f5b5288af55256ae048be98f2dd1b8660aad19d1c6345a11127bf1519070e1dbb309bcbf385dc3d5f16a387bc46ed8f5290e15ffeefc69295bc95528bac8f7871dead669e44cb76930354e4824d72e9808f50bf64a4ca97d9edbe277d7031b204ee574903ba88196dfa9b2221cd1e4dbf20cea4600665c5da1bef8803226b3e73bdec1e7889f3"
        )
        val state2 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, normal, TestConstants.Bob.nodeParams)
        assertIs<Normal>(state2)
        assertEquals(state2.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state2.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
        val normalWithHtlcs = Hex.decode(
            "b2dde23d177e42afc486705cad34197df31042fe7a0a68f4b0fc12fd720ca8b40322fe8de57baaad3277575014ce70b32d8881505164cdc8993b4ed59fcd0475ec90d85903ad7fde60f42527321feb5d6f92278b5d629fc2d21d1ed577a719d23bb419a52b8c3aae4b4c3ecdf5de4366c7b44054607d37aeca2a1ad5614a9aab6138dd3f12e911b62e0e67d81c41b2a2ba414528a4e780eba69fa23517ca62a5c24df1e7dcf2732a31624b838e0a0e85256f338d0ed0ecd292d0333008c5c3e263f704fc6be182929769a8c9099f69043436231a93e3cdf27c22dcdf1076636c388811a73b73d55396129f9061ee1f27e96b3ad40115d3050c054fb965efbb95d475b33b2f91f39ff78096fae8433d288b80b096dfd8b15c36ad8313579b7352314b24732750dc6b377dd2688259db255c0a45a08b98cc03e66919bdd6fdfed604eed208986fba2164d713e5264e5a8896926fbcd242c8f47fe6bf9af009e0f0806d947026312d116f93b71c79fbf1b24bd5a3717e24a0ba96dc93c4090a2a5d8518058f444c1189c7d5e6add95a6cfa3acee7d86eae69a6c33992b396894628bccee1017ba5b12a2bb5c116045fc7b7feee4090035e98961a96f483b09548d8d1ebe9618168399b17e8fffa681c54f77513f70f1e16c5f0b3633a1e6156a085cbd76fcc2be88e9173094aff9932c69490e8f8137f25924e1ebd9d596fbad5501e55d54e1cf07e71867dca5463849acf8097449c4954e895e0e2dbae1d193217c2064458e69a263c5dc835a117dda76098f6db567ae4d809612afef98b74ea2468261017dd52d8bb902e18958f567282060d9ae333aac657de92e15314983caed79985108b2fd31817cb5a7a91e26eb7620d9ccfdca1fabeceb38a8f87ee4e32b76787a976a511a509a6a346a3c7aebfa56e5158edfdbbe9620cb11baadf51a9cb6aae091eee0b5454f1fc294a681d5d3ce699e9239e628bbb199a847c1ef6e780c33d9b739d2e58b2260a39827dd102642f2e48ee7a983ba5cbb57d5f5a757eeffc34a4c597aa156cd298f69da33912e77c2080d8f0a3418282f734650ef5df9cd96839f20f3abe7f276442ae93ed02d951b7ba715ca6e253734ad72acfc6236ea956b7b5d9f73960bb1dec5528fafbc048cd7e61d514d5fb5877f553ebbcae5435a5b358cb6f2acbcdec0988f32fccc61da427d400297903a3ca2f7bd75c659bd64b509ded1a7f13a901160140ea0a5fbb73e696f5beb6cd1e53861ceea5458a3a49340134d44d1e98549421ebd042aed494e6bf3cadab78dd970744181542dbbb0deff849904fcd7d6de4afca7ed3084b0fd90f50f8a9134c31948443258712b2aa110f579ec9ec238980f77183129f867f28789b8df466f1a67ed1ad9b8a53f5f7a494da33a76c9ed92e2bdce4afa1887a51f0e83f0024f227e38f752dcc339e20a6292e05ac3020cf7109fa94081fc51a1d08a4dc954576f0554dfc89b092dffff16a5a57528b5ab747f4338011f6c7b87e90f02b38d2b683edc77cc9e3ae2a51e670b8a7de005bf93e90e654f48bc8c562bf5b30b1dfe476cb04bd847f680a568198541709d49e7b1fe740e510c7a6c772b36ae12bdcf3559830429f363840d6128a1ce4b20109ee5373782c2bfc8fe17ed3d8fbefee14d6880cf45e0bac74f73f77e72a8f2883fbf500f7492d43ea4efc3366a8c437002f3006bf6ab6841b52fc835e672fe5a11e137cc9424952ba44ab5345ae1c78fb004f840a29b5a00369ccacbdb64832287a698cfe1313996a632f250243379f8680922271a4ae33ea8e6d99b9b6c634e6deaa51db214b40066bc4b63f42e51a045565eb8923cc6d79bfbeac63c23f87acb3e4ff0560ab9142e8981597dca289e64025bce23bd49af50aafd972defe37463e99e15c8fe58599852da26cc837b7ce0ce59c26d6e1d1793ee1dd47c7041620b62f6cb75e469beb70dcd4391dd0f2114a993f3fb304f487b8004981c8d90fbf496ebb451364a58bdb2139f635e20eddc3c7cd167c8cb3d0698fd019e80c5abab85f1d124dad7115df6eca7de5b24e8bd9e2e032a190e222e6a1c7541ae66aa3660124187c4a64af9c648495fff20e5f339a0410f4180facb7671bae6b53bb3614faa3ff7965b205d07af9aef911fa9e63f150d40456682af020397a92fc0ea1ac7e451abc9b39fc6e332fc68ef0a40a38492f14af2f8d5c2eb27440207bc100616265c20e00400ad486c8597ae7a7e434dbe77000b6ce2cbc110319321213c6435854ae8f8e9cfe92e27dcbaf93bcca8bce9f66d8b29c581295ff23882e9cdca1cbe4bd221335787ee4c9a3ba369dbb8811c8c3f6595373af79a27db172c9ebf99fdb387b23b7fbe28b96993431b1b3989b52aca347be8d721b0b9f5d01d846a5371a9ef90b34cce5847ccbcd2c2b8ce109c3ace3f74f5c25dbe80a66f95a23ee318b78102f29ff30b9d32d5b91ea6b25e426a7ff6bb152788e87a32e96906567a5d76feb656b529bf1bdec293c61ed13969f012dd272f050205a664116413b9df770081b1e963ce430c26e8dd1827cedebc5fb2e4533524abd0d7afdbc6fda6c8df02170fcfabd895d8925ebf41badbffcabdf15eb8946c0e78d31707a67c9566b890223afbbf51057ff34621568b55433dab9e4c9774f04d5e95fb3602469a3e64d997ffb37eb2b519f776d33708ac51abfd992c8e4fc83aaad52cbc8ff650bd4001e0e6aeec386d5c783bdb6e089db569f7bea3f6690f96324686dd717d069a29cf8a87ececb53bc21812bd3ef4f67095e0a7506f52d47177cd51ad20b8f543ddeb3b0e6174bb68c7b94a19b6b2e05ee1aff094b47820dabf6225c0d2314900005c6bf731550d91440e81ad9f8c861e0cc5b82628b61f1d48901fb14f5479d8276849666470ecfe02d190ca1f8b4a3643fc908431d3d408f36ec78b18a21bdc20b6e17669ef769c93ed9523afa5ef40427b2e97c06366f311db3e34fd45ced0adea7a27b0d4af42845521cc6528598ba7636321715b9a3819194d5bbe7cf289bed03a603fdcfb184212844f01ab98f05a8f13fe4a96effed3d0d554e5a7980662b24d8e69123a82a971501f462783c371a0d759eb35b82cf81562ed10725a23f37f1242dfb42c1de24952780371c7233f10d0d8f9684f68baa15953cf2416c62e08db675e8650b13f23d998e11e093bd96ff0f93982d0bd2512b2a47f7c7f744af7aecfa7e56fe356d2c3d1a017684a34b75faa44050232b2f75783519a995db05f9e4c7b2de3cc4a09a35181bc814fd5fe3a036945f548d5f33b651b7f5c9dc3118c40644d4de5d64670f23148d3ba805a29e9d5b970bf2d1bc59e6b88b715a1818ee4e890fc62a5e0377b397325444252e30e2510d3ece61a784f2f680e15aa85bc349e9f9d0f155df64049d67576d933e9c253836b8e7146e0259c76ee22bac403209b68374956fda31d2488cf559bf28012cd2c28e7b42fe1fb9d4239219aeaaf125cd7d92db421701bdac588d38616d5dc61d88f0fb0360d49cffc68e959b2c17bda9b93838d1794a311a9160914f4a97c26817e78abac4c581dedefb42493083dd5c5243577910623a8e19b91033ac348cd624a81f97febbe15b48054a33f8ca51e22187067ff597c1db501e04d69d66b999b514ce5d531146e27d6d3c891bce0f6453ce4f4b8e1d777f147a2e53f5bb76b36bfe2ea02af9b9a8b1cf7ecc21c5b52fa94bd838ad119e44bb91ede5cd10f51806b2b4156b1a6dbde56a0d07d21c3ecb523524733bf34a76cca4c8feeff27e70044532c6b79e2ea49f4b2d771176849e4581dd3ada230376d6b64ce32881688c11d7e144c7804e2eb067c214872ca181fcf0383dee6c300817fe01532245053a2d6b3832077aa5b47b958e891beaac5f6cfbf5e549fd15cccdbb4d20643f7115b9cc3756ebf139e370b95651f551297aed765ad244fc37572a27bab4e5d86c4dfa2b9ea7575b18be32da9ad6b1fac7df6008b112db0c0594d412ec4a7da0cb592edcbba44a5e4deb650250baddb33f9822ebb35881479e04738bd3dac6cc74d294c883f3c6132834fee37b2c6102f6dca39d22e632486c07ed64c422b2b6962f7fdfbc69433c94d8899f7387d36c67e7b254168d45c0daefc03ffaa3f99592ebac4fe5e239d5a467be31380ba1ce4907cbb404a11623a09bc8f7b3db2a5a5c61f4ac5023d40457f8c6f82ad25ccf59c880765dabd23364793863018ebeb810de77ab11303dc02c6abda98797dee47854d575c462bb2c95b28204f44aaf014c271023a39ff7d0205f033c70b3dc716a67aa0da1dc11157eb766423d9ffd1ecaca168584eb471b436455a7f71095a1e20ac3be227722ff5dab36fa6dab111263c72c230a638d2cacc7a802dd316639138f5eaf371f5743301c441f34b2797258e8718da17d5b119dbdbea4ff7ccdeabb05f69ae17edde0906f7c7ca15c963fb4d8b6515834f2307fcd9bcbfc8d638aeadaf02a45d8e872e9d8a0f31a4e40197b9aafc20bcae30d63be764a73494c530d9a3e37bdc987a2980b7ff72d38fea52c2655d7d3d606c0cbb1f93367b1777cd723867e9eb4f1e55385f8ed18027b568864270bac42957d3670873a0c3610f8c0eafdab5bdcf0a22e3a1efc3aa7564e355ae1fd2914fb43405e37ed40e7fca5d8f24b6137575d6da94780ff01d5f752429a3cad6d59200e553abdcfe40a6777031d1b5d6004c1af1b67e8815f012a56d1740b16396752ce90ca088ea99fa8c39ecc28c72f2fb7e2dc721e3e4e79d8cc41a8ad289090e838c4224c7eb80a902de05c964ea5e8c4654b3592d2a9140cdbd9a0eeb66b33f89a5effd828404602e0949d389aa5a8755a7b264ce3371ca4667403650f1b717ac00603e64877a8f1ad99aa769e8de22d2959a1aac7991acec5b0a83126d9e096613dfbb0aa312bd3b62b54b39caa4a8baf2e79a865dce6c4e0d6fa86d416f71cf1f5c584da83a4ba10f6a95090e3df948b673996fd4f5129a23f8069747bd6420bf5c823caba219c70c371169ed7afd5e93630ea8c76e53b88660b2020a6602852bb180922f058620e89cf4e2448344ce2fc37aa0767fa381a0d751a8a3fd4540d510d8d8b1788f614085851fb7f8f91e102eebbc31e7c8a74b9c66432e43dc939b240e65ea84327d13a0082f4765355d89d848b6a53486df9cdc54761b46dcb6590e5faa7348c5bdaf065f79b8d2775db11c1fdf4d945eb4a339cd1f4119ea58b48558255905906fe8cce18fc38855484ae2ae00bf91eb0932039e03ae67d546aecab5ae970c070b07831eab7dd29737f66b79b2a68028c0738af30e863fbed7ece9c56eff795abe06f3799fae92ad3838af38a78543418006f65b7bd0b3b1739c213878e4ab12d858f52277ea471484fe3b1d56525ffbceaf9c81b01661ef1521d912e9f6c5adbdd6b4164aeba74e90dda31a58df396cddf75830cdeae5982b694993a98788816a9e59deb80fbb5b7a112d1271762b9de0327d722d3491a0738edefdb23d6c9c1e890e3d706cc7067d17279cb4e66e3d69874bea0cea6a12fecaf763b13b5e5759d33abec1d05af7ad94e7bced28b019d8faa0da8361960a061205293745f3e2890873a1fcdb826211aeb046c96dc4ae1e1c385ea770ad1e7b618a96cf08b7168155a285bcabeac2909eb582bce065de1425b7e3d061a7692bfba760a0f5eb66540511db21b155cd6ad114a84ed9e316fab29c1f5564d1bf14e6973ab5b1fd19032520c69fc56348292a1328c40edae173b859bbe57ffb6280016c90b12a744b238db9dbf2270ef20cb230bcc9b0fb452042e1e2c7a2ac8028ea59d10ea31f169325a9d7ba8d8b0ef424745c5c38248016cf69a44e012677cc9ac9c75417ccae772aeffe22337c8b258a31475062a5b0d2d47749499333218b2e28d6eac8d605da5c49de1b88be0257462ad204dca21acede937e76e871643d4877a1c2249a1bed1ee61b1c9567d5fd07494efd160968175c0b0cefec4ff3226f3b18bb6ee3a292fe79da874ae0e402d4319697bbcf6773b25f240436113c3dd484e72770674abbcff4fcb2b11350a0f86f26fe532b8e05722c387d37fd16866cc593fe5fbf9088388dcceffbce10bac2d3feef20d063d49fedf3ef5b0bcb62a0a0447b479905830aee988c0743ad435de337acfc9a6c3ab2358473c05b19df1eadc48379cc6f18e0524e70188c0f12cfe93deab29c07262069d309c432dc24d0834740a7acd8f6bb1dffdbb84629ddadfa18397e4e62164a711a37623b9b214fd552badc585beb9164346e021ce39771a5274b6ce34b6fc83f6f9c660ca3cbdcd93e14ce412439281ce5a7b518e96336bf1ebdbee4d1d1c2f47da1c54a8cbb7a6fe8e1f3b5ca6c600afe1d62295fa947f3fceb85ace588668f6f32e47bb46ffe6d780d7ae2415a0ad01d622e6f04c5618fb35b88a882fa9aa3f13f2bd42ee40fa28df3cbbc5bd06b261d6e020b24695352311c8cfc9be042a31a12be8b12976961c20719423a2fbeb1c108bb75ebba53ac8171b8e9ce20de42919bcb96300530d3388d74471784d1e3c13d9b7630fa33654a5a82c847441e13346b45a2d0598c765a3080ea178dfa595575d7ea701ed683615d949c288977cf163ae012e99ee802a8c3bafeff7bbf400b20d6674448844f6ebfd308524e428268f9aeeb188c3065080dfef67dd90c12f0db496840afbdbb5f7bfaff2200e8cedca7491679a44d90196faafedf4f210f361b9b272755d0adf01cd439154955222281fe149218de8c51558e69ee0d7b2a3e4c67a302658b0c80086404cc4b2f69c0e897e714d17807bb1e09601ed173153e713282e25174d891e670353e3c03190bf7db10de953f787c600f703593e4e43f612ee6774044ed167c5cc181e631ea927bc66e39ddce3f2d585793f913815e6b71476ffc29e721c38faf64aff3707315ef4adccc69444752220edd90d935ef89244c0089c347af1cd1e915a32c56aba6e03d09f68cf25f7b6b37d9f08e27b501547e9b255c2ec7839655cc2528d59472d992292e0c711dca28e254273c77f0defe2994d1551c17851e98ca93cdedb0ef0a789f4e62c7620de64b7f20568c6dff140f13a220d7fe34aa43d4527cddc0da14799d6397023b3a98890458084518cd8a486783c6bb59156cddbd59179b936fcb996797c032cd2535b4484ac27a23cc9d3c1d241de2fe2292a829b59d4facaff1aefde6a480a4f29a6f9afcfc60953a55190bd12830b568b10ca574f930fb60572cfe6aed561dd9ff1554f61f5ff4f0f5a21fef7e9283ad77ab4135762b17d0211b012c333296c3e29adad8554cbe54e3344b7fabf131e8fcb0e9a49af83d6e83ffa7faab4e35d9120cd4ffcdc1bffdcba0db20e2c9da6a6cd83ce14da60623e3170463753d0cf6f78f6f406b7162e975a11797e607a2436570b35f1fe2d3a03613f92e33ce0c23c057ec362bda8eec953d73b13fb096f2520b123c60831e49f396ee131ffe777c15fdedbb873911ad44df2ca22ab52d29c8710ee5b07a2cc862a21893ea69829d1da8fb72a4c63bcb89df3320171122012886e478fd71e1343d2fa51be1098a74b88f08c0ea632a6e76ae489aed7695ce8d44fbb622e22716c4ed557672636d329d1de14e1f764cd170d13bd79d9828555ed477069cadcb7dfc4bc5d1091f4b27b6cc738d62f3067c3b3c1181fd49c38044aef6ec08a843fd74cb95f573022f8f0be921f9117ca11840ae4ef86e30bebe766903302c8a5717338fb8ab7e5c88f697abc5798f293df6483ba48e89e084ca9f6bf3294d1d2b04460f0d96b562da8233df02b8391406489857d46154f2c80f7c29a00a93567f9d88259a2fbe2364c8d9841009ff5c86cc0803ced5c0f93875365779686b59511c801e0450c78abaa8fe41c95262bcb10b16ba429abb9c2ccc0cb524b750a5ecda217128e932f2bb644211f4148d2e5905f64a69895f5f65f180ec06c58b359fc5b3bc748c2f68e48107edc3fc6042844c2e3e3009fccecf2bd62dee85c2c47155b1ed866b766ad66ff7ab351880d0144ced4722f276613c4a97ee4ed4acd7ce52acc697e7d4c4e61bcad4bf27ec7ff8a553cec433df78740cfb0312c94799c39b8f0c7ce1160755b593973a6a4df80faa44c2d25540d3b971c1014390ba371727982dc3e320c4d1a9f64dccaf474c4cc6e23b281970140070f3607375111370a1848e2cf8048e6a3237eae3c99deea95bda4337b6a38ed74f72cabc34fea0e3bf01074f2a3b4d21701da5ec6eb13d888cf29632a5f8bcea160c47a0048f72959713dd5ff6c4e71f369fb092cdf49e815125b127fe4b401e8976b40606dd55c60a12a32e8011eb84c2ae374b6e656a49683a5b5127568dd07a2a2faa41e586edbf73403792532bb910f15614225b95fbdeb81d677276957c0bfd2109feec9cee0814613aac201dfebc2269bd0ddeab892a27bb7ba431f99937fa74f8f3841ab61632170c3d2db2812839b38d7c1c3d50e932deb0304a2eaffaed4dfc619ca43f68d82a47d3e75fe93c22191585ef8a8aac2fbd2d8d021e19347710bbe6d44936b30adc70e7601ca25c508fe9d3684d6c5322f1b7331f89afe92df50000867f4f4d28c1cadefdbaf67a21f7a8775963daa0e7206dca57ecc46126f7cb7a376c1661c30246e2666b9adf67be533c44e7417c3724d5037fee98e0ce40d24ca3de6fbd8d7237c5532d487eefcbf3011252818f8e108d321085ab35fd9046746f780ac388e869a6beae1818b3cebcec51064cc2364dfaf200f44a3465dd06749dd32f44b6183f32630446325e94e73b2569b380e4abbb88fec55883e80bd01e40b5013f9462bb54c449f3c2357c189c5cc867af5ecf55c9261423f615657cb9a3b1ca98e1909e9c895de7abf64a0654c6c06324f99dee2e376396d3701fbe5c9bcf3a9507f1e44dfd26355f26aafdeda44ba381d2636d131a46152ebba738a1661b469fdd50970aa47d6daa271606166454326e7601fa6120c0992b361775bca4204e362109e51353627b84e9f57909d756f28bf87c01e51dd3825145a7ed2eed5c5bc6e16a486f42f69a9cb89189c26653e9d4e3e8446c791d44754879d18da9ff6ebab956f98f7fefc40fcb34440879b82ae70d5d13949abe72bd61be9521717778f56bff5e325212bd93aaa6921bad268d4fbf3e5e519b13fc835fb10633f222493c8dd8ddf421843e96e636d17049e6668c90ee2addd815765b49e5251ec644282ebf455837717cf6050d2764ac2b482861fe900cfaddeea646c9684d4e9afd6e60be12b46e661f6faa8996b93dd210654ebbea12dbf72ecca826e45892ee181c9c73e9b93ae24b2fab1be87716c4ec7ca79dce8a671c2246bd41bf018943a980706949755e1e9ccebeb205fb03db95b01660df0f92f868e65c10bc817c2d3ddd89a9941a9cebd015b6fcd52553b6773ad29824c5cc6d903f80d537a2c01b687be1c27e3d4864d3ff9ec656c9a87c9adbce49ba0b6c533d5516785a5d9cc8959b92b50bcf6e1a6960a83561e882fe97389dc5b536e7a4391cb05738e5c55f0abe5c4c34f942727d3831765a764b82ede1daf15284fefdeacedeb4d88b47efd0d9677f5d0c8d010275ff2f556cd53d86edac0ae1ed40f54369a50984597641fbe1cfb23eeb0cfddf83949f2e759e47c91bfc8e780a8866ef96c8e07770821663b4a616dca4b11da28d56a51557c6b77015c763c58e9f8aeea7600d9cad1bb9de0b41dd4b477ed375c2c4c87d507899e90844f0a4e22b605278cf0775a62102d5cac85d212fb14eacb31c9aad5de685dd66c15ee049d621be84631704696dd0945dbd80a5e29b5f02236f736bd44af65ab953e858e64a2d90e07f9a6f0369b1b2d143ef34d166981207fe95e6531102cd1e0d70b27c8ea4915c28f0c70997e85922e33f37fd8ccd374008851c9f9cf397f8c539bd748b5e13b0d8818983ad080ef2463e97710f256a39a2d060b53938b2a31fa719ed5b0dbadb780f348fdba656cc3ef1e3ecbbe7ef0d853860fe6bb427d10a1d14269bfc0f30b0b2eb495de4a704b6586d83c4c8a8428eb8a8c2939543d67d29d0906ee10a265150305b43cdd07833e0b820b2508530f20472022e843fe1b97a87fb040a27a7ead1becc16085f6ecc35f9d11cebbc155692f5e46334961afe0f74056b72bdc3efbd2f5486330251271e34c0042c6077367beabf1b588f9b8ca3804c03a4121ed445284cd547ab74ed9663538077ae2ef6ce88ce1e473fd0e3c30c75d34a846e409d1af9691ef7b19ee4f7e4399319e6e194edc9f4cf2a140de036f96be449913af16e55b333e8c460c2ecd255b07d91c88227015d49d7ca39429bfd463ddcd66b98e1a822821139c064161e60b6bb25fa9f662ae078534ecf7f4b035fb4d57b1f7f0399eafe61a621f5bc2eba3edec09f203f803d52c1fb18a397cb8e8913d420812ff191b13a2c9426ac84bba4a9f652961f1fef6a778e41bd9af4c88a14d9f01a1b3543fe9f35f1037926ba5a905d1003765bf68f817bffc8f0b9e2e6e2c3738c11d8abf8c9d7d62d6c3d17c5dc8e10e0286520d387175e542c2f2f15f72c865f475b5a24b0ec98e6c11a04fc68b98fc3b89420c13bf39c3d3a2535e676116a416e89a01561ff395739899203e8d6bc1c76222ae94d8dfa04eed71ad0684241bf0e974e117b4b4c67e59cf7aea51a53f40c7dd2438dc741576fa36e32169587e669856f7403e0fe351381584f849200218c140ee3225652ab5327759716c97fe4cb8d2084af5c946b76540c8f7539b5ecfc397e1ecc32120b91a8ee6c37d34570ed86f7f27d2b5c14625204cfd128f900d5b53875b833369c353472d2736210fc721532b26c14d54b214b40ef83d2be182a9690a60b225feba72f1cf1512d3d179bde175d196bf89fa0e506f6f6218381888abdefae75b3fd49efbbb6701dfe64b17c0a064a0e84d8026867eab19b0600e773f7e02145910b0140b30aab4c08bb127d0240a22251c3b9f218a2637f07a261fb3c084aa8f03c9cc5e2b4ed1ec3b838f7e887baa03f98b6e17d18b74288a6514eed93a116782d15f54e212e7e9a3aa57034576cc6582c8bb352e0371535a3c2de6290805a13afc34cafc94aac682806f070026b3e4415f2cab1bef2716308129fbe6c785f8c89cd8703a92e737168082d4a0a6764492b6974e7df3d81b0c53704999ae809ed615a56da728ef06398ac0ec07c6c3e4e23cedd633f86a9afbfb9a5c363aedb7eeef79caba1fef5a0a8ccfb98746ac7654212e7ca3580aea945e830f32bc4e4bcbb5897abbffbc6b66a3d52333b3358d5592848c0b1277deb6654b09d816abe5702f44ea5cc17a956167f502b03548e22a9a0fe82b2793a42571eef320e3b6111ab2e1792256ed7eb411797503c6327428fce157f1fb19c177260492f1c4ffa4a860901f9d8969e5f8c65ff3a87546cb51bd789b683b7bfd80377890b9e8de5cb15f876c6a5ea331201883e1d1684b7d444a9526ccb41138b1c605dddcdb50fef8c072df055d6efe425953abf8d3f83315699bdd7a9ce1db9f546fdb04041c96882db8c64b6634e4d760ae4cffd16099e107a2d2962951ce0073c3e5da2b1ac6c577421ce1d67476d8c66bd1e86ad1873662e06cf7f8aafe38fb2ed61e9e8e7c8d8a57116f2365c1dee5abe0bf9908d57f62172e4a7f9b07d27249c301e3d76a1df5c08d2e5c96ab846856a3ded73a4e8ac1a19c7a0740f2c89bcf273f914d8ac98bd228b72af1ebfa144ffc38617f72f8e30bd7f7eb1b6c49756d0647e7e4757ba372785f0d061d97f84e25df0e4ba04a8616671add4845f811208f1234e2f5457bf2974cbf0625cb2489468a00ffad04e8b8f0657dc98abab9c5268109da7030808afb3c1e7663ad846235a1a357da359adfc428c254390d10997c9625a8ce248cf5bdcf40a8b094bd67573d8d3632e6d0431c358842044828232f36c0927bfecfec751ce3334a0a4a68e90e292a1b4a8094da322d984472b529678fd4a7a9392d7ef83170e52cc137384696f9842598acc63162cc7d2f4ef5977bb252956d79231a88c74047b59086f2b0a112d4e4c86cf852664693e209439841ec9f0882d74cf79825d3abd05b407681a386e032ca9daafcc524ef1d3d50496a74821a944865fdc6f80de1a7c4c51820516b76dd75fbb5b7a13088b248839f9695bcfd000e084a2525afb3135e6450410e84adada625383939afa053934a84c8c0b538dde8f05ddaac5758f03468c59a91c5e69772211808f54d7104715e161d52ab6d119a2a6d52516741bb9349bc0207dba6ea2a8dfe540e3a75e7d9c3d02f67b6351857e5ff03ac49cd396677a8b6f2ecbfa659c8c02ebd0efa29297df6eacbe809a159c3c51f499969759a8593cda0e09cf8ecaaacf68414f2782a33885277a4f30ac516a43de40ef8ee77d783dcfb7bf87a32836ffd6e6d6cb8a56babdb36305e8a2c9701e4371ee9788cebff39fb536468592ec86e445aeefa4bf55b9bbf27daf295e7c28c6da17301d3b574dbd658c90882ce406d3537dbcf81a8916f9cf9198c3f23ea8664a1cf003da5bd2dd42c8e765b821adbf7e4a6fffcf9077d250fac9323383682fee1ba5b73de60a411478fed26969fd81606f0d206fb919b12052947861bfd591c2b63f188f8af463d6a5f59888abf3bed734c9ce4b9a92854a9fc7c8a7ddb186166b80a8b8b4524ed3026fa0e087fc68d8b0c2ba169695d231ff4753a22a99be54cd3b3f6f1cd873fe2fb699fe2688c71b61df0a53468bdfc23e146a6213887ba3320fca2533e31960643f017cd1b07fc1820d38db1de15ebf169dfb193f7f463a4f7198cfd1f6c1414bd26b4fd66515740be209f942ae7e199909a476b2dee979895c47ca0243605fe9238c8fd94bf9986e4dded3a36124bead2e7521e58e682a7ba4c005dd7e709dbefb6470c4f1957cd148c013779df74917150a01a841ec967c62aeda6dec9653d686ec7755cab7efc7133d7bf7787aa670e68622323ffff2a10959cc99158bbcb946a76d5688a00baf8984d38b44ae5b4d9db7ecb60d90524b0e49ba2ee285381cef1fe9a2488be54b4816cf7869973f7be57f00c67d47383df37e39cbfa69d5316b1dc90c291634ed8b73b3273a4d959cb9c305d976cc4872d7a85a863e8bd8898679a4da54e8a70e5dca541e4fdea5e284ebfba9c5d6ea7a4b2f06e015286d591562b00c6de9f7dee8011fd1ab58ce7eb0429c0202357e9cd87748315e1dc5cbf2068aaff1f7bbbfedcd88de9af834de1bc2a65f95492f6373e7b57596d54224392c5b223093bc41cc2b9d0dbefc4c4bd38d4efed82cf555741fca88c58318dd475550a080910a644dc80eee9426d18f76ae6aaeeeed14f561f7cbc0e7473c3e7f673e27eb69c22c811184411072fac92a1a357d6c3c897544cf14706c7c7aca0ba7aad5d5660bca5d605796e545d68fee128930bc13484051ae45f7dad75166e3ee763958a9fd98159d157b2132795f0e0ce7a4c3ea095fbc02531e50285682b99e00f6313967b28192e428c936ecab2733ba4ab8cac61cc1d39bb3feae207d121bce25f39e1fdd30053c04f937a66ed6dddaba10f4da348dcf30db2ea9172de7df4fa632072cf71d114f9ffefefcf7f5a8ecaff9f408845e6c906329b3d930678fb116e6e90b8a4706d57d8d0496ee9d84370817dc0e293a0b767151dfb2a9560b554266233716292cd6a9f7d98f0b513f921b36e4b18048e9627896ec75aef8c4871c0e9a5ae2ebe37a9b279676c2c166712b481a2e59b42e595bd3a7660528bd5ba7c8114f604771c368778f6c4e4777a051a1db06c9bd3cee47a0788a468febc2b99bdb69c4568bcf377bb37e0331b83d08d7db2e22f96d6049b8c63199e86b64ba902938f5149837a617bebdbe109095ee0d578aac2cb338d8834dba7504f94b162245e3bcb4460b7d9c020469d83ff412613dff7b864c964ad91ffc7618253d554dac963ef8cf4f5e9d4b76e9ed86dcba50cc0b5c0"
        )
        val state3 = Serialization.decrypt(TestConstants.Bob.nodeParams.nodePrivateKey, normalWithHtlcs, TestConstants.Bob.nodeParams)
        assertIs<Normal>(state3)
        assertEquals(state3.commitments.fundingTxId, fundingTx.txid)
        assertEquals(state3.commitments.channelFeatures, ChannelFeatures(setOf(Feature.StaticRemoteKey, Feature.AnchorOutputs)))
    }
}